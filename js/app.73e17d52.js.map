{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?f446","webpack:///./src/App.vue?416e","webpack:///./src/components/OptionsEditor.vue?9c63","webpack:///./src/domain/models/options.ts","webpack:///./src/components/OptionsEditor.vue?3657","webpack:///./src/components/OptionsEditor.vue?d45e","webpack:///./src/components/OptionsEditor.vue","webpack:///./src/domain/util/util.ts","webpack:///./src/domain/models/notes.ts","webpack:///./src/domain/services/midiBatcher.ts","webpack:///./src/domain/colorconversion.js","webpack:///./src/domain/services/colorGiver.ts","webpack:///./src/drawers/RandomPixelator.ts","webpack:///./src/drawers/drawing.ts","webpack:///./src/App.vue?ec60","webpack:///./src/App.vue?640d","webpack:///./src/App.vue","webpack:///./src/main.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","options","canvas","width","height","model","callback","$$v","expression","staticRenderFns","on","onJsonChange","defaultOptions","display","waitBeforeClearMilliseconds","tickMilliseconds","circle","tonic","degreeOffset","color","lightFloor","lightCeiling","saturationFloor","saturationCeiling","standardHSL","okHSL","viewMode","single","overtoneGrid","wheel","randomPixelation","concentricPixelation","wheelViewModeConfig","showOvertones","showEmergence","showEmergentOnly","lineWidth","spotlightScaleFactor","mix","rootBias","melodyBias","considerVelocity","render","middleBias","emergentBias","emergentBiasFloor","decay","decayPerSecond","overtone","numberOvertones","backoffCoefficient","newValue","emit","components","VContainer","VRow","VCol","VSelect","VCheckbox","VTextField","VBtn","vueJsonEditor","component","mapcat","items","f","forEach","deepMap","map","is","flipMap","arr","midiToScientific","midi","octave","kind","class","noteDropdownOptions","num","letter","toString","NoteToMidi","note","toMidi","offsetFromRoot","solfege","octaveOffset","_notes","Map","_sustainOn","newNotes","k","sustained","set","velocity","midiNote","timeFirstPresseddMilliseconds","performance","now","ageMilliseconds","undefined","delete","notes","Array","from","values","sort","a","b","srgb_transfer_function","Math","pow","oklab_to_linear_srgb","L","l_","m_","s_","toe_inv","x","k_1","k_2","k_3","compute_max_saturation","k0","k1","k2","k3","k4","wl","wm","ws","S","k_l","k_m","k_s","l_dS","m_dS","s_dS","l_dS2","m_dS2","s_dS2","f1","f2","find_cusp","S_cusp","rgb_at_max","L_cusp","cbrt","max","C_cusp","find_gamut_intersection","L1","C1","L0","cusp","dL","dC","l_dt","m_dt","s_dt","C","ldt","mdt","sdt","ldt2","mdt2","sdt2","r1","r2","u_r","t_r","g","g1","g2","u_g","t_g","b1","b2","u_b","t_b","min","get_ST_max","a_","b_","get_Cs","C_mid","C_0","C_max","ST_max","S_mid","T_mid","C_a","C_b","sqrt","okhsl_to_srgb","h","k_0","cos","PI","sin","Cs","rgb","rgb_to_hex","componentToHex","hex","round","hslToRGB","hslToRgbHelper","hue","saturation","light","red","green","blue","alpha","hsl","hue2rgb","q","hslToHex","fifths","notesToColors","config","colorConfig","pn","noteNumber","abs","hslToVector","y","z","vectorToHsl","v","type","atan2","mixColors","biases","colors","velocities","totalDivider","weight","cv","colorOvertones","make","semitones","lighten","desaturate","counter","addOvertone","thisWeight","normalizeWeights","weightedColors","totalWeight","wc","reduce","doNothingRandomPixelator","makeRandomPixelatorConfig","circleConfig","mixConfig","renderConfig","overtoneConfig","decayConfig","makeRandomPixelator","ctx","dimensions","Uint8ClampedArray","imageData","ImageData","midiBatcher","tryClear","rgbs","generateRGBs","floor","random","putImageData","getNotes","rawColors","cs","withOvertones","flatColors","flat","drawingPool","drawBoxedImage","boxedImage","image","box","xOrigin","yOrigin","splitVertical","percent","leftWidth","rightWidth","ceil","leftBox","rightBox","splitHorizontal","topHeight","bottomHeight","topBox","bottomBox","makeBoxedImage","pixelFn","imgData","ywidth","i4","randomPixelator","concentricPixelator","emergent","vs","wheelDrawer","hsls","innerWidth","innerHeight","makeConcentricPixelator","makeColorWheelDrawer","addEventListener","resize","removeEventListener","rows","rowSize","colorsInRow","cols","colSize","thisColor","beginPath","fillStyle","rect","fill","hslKind","centerX","centerY","radius","console","log","dist","theta","lightCircleImage","satCircleImage","arrayInitializedWithKind","circleBoxes","gridBox","lightCircleBox","satCircleBox","allConfig","makeLightColorWheel","makeSaturatedColorWheel","drawNoteInBox","magFn","isEmergent","spotlightSize","magnitude","arc","strokeStyle","stroke","clearRect","drawAll","hs","hslWithOvertones","totalElements","multiplier","end","begin","midpoint","useEmergentCeiling","useEmergenceBase","document","getElementById","getContext","noNotesForMs","renderSingleColor","renderOvertonesGrid","hexOvertones","pixelateConcentrically","wcs","emergentDrawingPool","renderColorWheel","go","tick","runLoop","setTimeout","enable","ex","inputs","outputs","input","addListener","e","endSustain","beginSustain","handleNoteOn","number","handleNoteOff","OptionsEditor","VApp","VMain","VTabs","VTab","VTabItem","vuetify","use","productionTip","$mount"],"mappings":"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","file":"js/app.73e17d52.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-app',{staticClass:\"ma-0 pa-0\",attrs:{\"width\":_vm.options.canvas.width,\"height\":_vm.options.canvas.height}},[_c('v-main',[_c('v-container',[_c('v-row',[_c('v-col',{staticClass:\"lg-6\"},[_c('options-editor',{model:{value:(_vm.options),callback:function ($$v) {_vm.options=$$v},expression:\"options\"}})],1)],1)],1)],1),_c('canvas',{attrs:{\"id\":\"canvas\",\"width\":_vm.options.canvas.width,\"height\":_vm.options.canvas.height}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('vue-json-editor',{attrs:{\"expandedOnStart\":true},on:{\"json-change\":_vm.onJsonChange},model:{value:(_vm.options),callback:function ($$v) {_vm.options=$$v},expression:\"options\"}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { Color } from \"vuetify/lib/util/colors\";\nimport { Note, PitchClass, ScientificNote, scientificNote } from \"./notes\";\n\nexport type ViewMode = { single: boolean; overtoneGrid: boolean; wheel: boolean; randomPixelation: boolean; concentricPixelation: boolean; }\n\nexport type DisplayConfig = { tickMilliseconds: number; waitBeforeClearMilliseconds: number; }\nexport type CircleConfig = { tonic: PitchClass; degreeOffset: number; } \nexport type MixBias = { rootBias: number; melodyBias: number; considerVelocity: boolean; }\nexport type RenderBias = { rootBias: number; middleBias: number; melodyBias: number; emergentBias: number; emergentBiasFloor: number; }\nexport type DecayConfig = { decayPerSecond: number }\nexport type OvertoneConfig = { numberOvertones: number; backoffCoefficient: number; }\nexport type ColorConfig = { lightFloor: number; lightCeiling: number; saturationFloor: number; saturationCeiling: number; standardHSL: boolean; okHSL: boolean; }\n\nexport type CanvasOptions = { width: number; height: number; }\n\nexport type WheelViewModeConfig = {\n  showOvertones: boolean;\n  showEmergence: boolean;\n  showEmergentOnly: boolean;\n  lineWidth: number;\n  spotlightScaleFactor: number;\n}\n\nexport type Options = {\n    display: DisplayConfig;\n    circle: CircleConfig;\n    color: ColorConfig;\n    viewMode: ViewMode;\n    wheelViewModeConfig: WheelViewModeConfig;\n    canvas: CanvasOptions;\n    mix: MixBias;\n    render: RenderBias;\n    decay: DecayConfig;\n    overtone: OvertoneConfig;\n}\nexport const defaultOptions: Options = {\n    display: { waitBeforeClearMilliseconds: 100, tickMilliseconds: 5},\n    circle: { tonic: \"C\", degreeOffset: 60 },\n    color: { lightFloor: 5, lightCeiling: 95, saturationFloor: 80, saturationCeiling: 100, standardHSL: false, okHSL: true },\n    viewMode: { single: false, overtoneGrid: false, wheel: true, randomPixelation: false, concentricPixelation: true },\n    wheelViewModeConfig: { showOvertones : false, showEmergence: true, showEmergentOnly: false, lineWidth: 3, spotlightScaleFactor: 0.05},\n    canvas: { width: 1800, height: 1190 },\n    mix: { rootBias: 1.5, melodyBias: 1.5, considerVelocity: true },\n    render: { rootBias: 1, middleBias: 1, melodyBias: 1, emergentBias: 1 , emergentBiasFloor: 0.2},\n    decay: { decayPerSecond: 0 },\n    overtone: { numberOvertones: 7, backoffCoefficient: 1.5 }\n};","\n\n\n\n\n\n\nimport { Component, Watch, Emit, Prop, Vue } from \"vue-property-decorator\";\nimport { VBtn, VContainer, VRow, VCol, VSelect,VCheckbox, VTextField } from \"vuetify/lib\";\nimport { defaultOptions, Options } from \"../domain/models/options\";\nimport { Note, Octave, PitchClass } from \"../domain/models/notes\";\nimport vueJsonEditor from \"vue-json-editor\";\n\n@Component ({\n  components: {\n      VContainer, VRow, VCol,\n      VSelect, VCheckbox, VTextField,\n      VBtn, vueJsonEditor\n  }\n})\nexport default class OptionsEditor extends Vue {\n\n    private options: Options = { ... defaultOptions  };\n\n    onJsonChange(newValue: Options) {\n        this.options = newValue;\n        this.emit();\n    }\n\n    @Emit('input')\n    emit(): Options {\n        return this.options;\n    }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./OptionsEditor.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./OptionsEditor.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./OptionsEditor.vue?vue&type=template&id=1f28639e&\"\nimport script from \"./OptionsEditor.vue?vue&type=script&lang=ts&\"\nexport * from \"./OptionsEditor.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","// This is flatmap, but JSRepl complains about flatmap, so I have to write my own.\n export function mapcat<A, B>(items: A[], f: (a: A) => B[]): B[] {\n    const result: B[] = [];\n    items.forEach(i => {\n        f(i).forEach(j => result.push(j));\n    });\n    return result;\n}\n\nexport function deepMap<A, B>(items: A[][], f: (a: A) => B)\n{\n    return items.map(is => is.map(f));\n}\n\nexport function flipMap<A, B>(items: A[][], f: (a: A[]) => B): B[]\n{\n    const result: B[] = [];\n    for (let i = 0; i < items[0].length; i++)\n        result.push(f(items.map(arr => arr[i])));\n    return result;\n}\n\nexport function randomNumberBetweenInclusive(low: number, high: number) {\n    return Math.floor(Math.random() * (high - low + 1) + low);\n}\n\nexport function drawRandom<T>(items: T[]): T {\n    return items[randomNumberBetweenInclusive(0, items.length - 1)];\n}\n\nexport type RandomSampleRepeatOptions = \"no-repeats\" | \"non-sequential-repeats\" | \"allow-repeats\"\nexport function drawRandomSample<T>(items: T[], size: number, repeatOptions: RandomSampleRepeatOptions): T[] {\n    const result: T[] = [];\n\n    if (repeatOptions == \"allow-repeats\") {\n        for (let i = 0; i < size; i++) {\n            result.push(drawRandom(items));\n        }\n    } else if (repeatOptions == \"no-repeats\") {\n        if (size > items.length) {\n            throw new Error(\"can't randomly sample \" + size.toString() + \" items with no repeats from a list with \" + items.length.toString() + \" elements.\");\n        }\n\n        const picked = new Set<number>();\n        let i = randomNumberBetweenInclusive(0, items.length - 1);\n\n        while (result.length < size) {\n            while (picked.has(i)) {\n                i = randomNumberBetweenInclusive(0, items.length - 1);\n            }\n            result.push(items[i]);\n            picked.add(i);\n        }\n    } else if (repeatOptions == \"non-sequential-repeats\") {\n        let lastPick = randomNumberBetweenInclusive(0, items.length - 1);\n        let nextPick = lastPick;\n        while (result.length < size) {\n            while (lastPick == nextPick) {\n                nextPick = randomNumberBetweenInclusive(0, items.length - 1);\n            }\n            result.push(items[nextPick]);\n            lastPick = nextPick;\n        }\n    }\n\n    return result;\n}\n\n// https://stackoverflow.com/a/12646864\nexport function shuffleArray<T>(array: T[]) {\n    for (let i = array.length - 1; i > 0; i--) {\n        const j = Math.floor(Math.random() * (i + 1));\n        [array[i], array[j]] = [array[j], array[i]];\n    }\n}\n\nexport function doTimes<T>(f: () => T, count: number): T[] {\n    const result: T[] = [];\n    for (let i = 0; i < count; i++) {\n        result.push(f());\n    }\n    return result;\n}\n\nexport function indexBy<K, V>(items: V[], f: (v: V) => K): Map<K, V> {\n    const result = new Map<K, V>();\n    items.forEach(x => result.set(f(x), x));\n    return result;\n}","import { Frequency, Midi,  } from \"tone\";\nimport { mapcat } from \"../util/util\";\n\nexport type PitchClass = \"A\" | \"Bb\" | \"B\" | \"C\" | \"Db\" | \"D\" | \"Eb\" | \"E\" | \"F\" | \"F#\" | \"G\" | \"Ab\";\nexport type Octave =  0 | 1 | 2 | 3 | 4 | 5 | 6  | 7 |  8 ;\n\n\nexport type MidiNote = number;\nexport type ScientificNote = {kind: \"scientific\", class: PitchClass, octave: Octave}\n\nexport type SolfegeClass = \"do\" \n    | \"ra\" | \"re\" | \"ri\" \n    | \"me\" | \"mi\"\n    | \"fa\" | \"fi\"\n    | \"se\" | \"so\" | \"si\" \n    | \"le\" | \"la\" | \"li\"\n    | \"te\" | \"ti\"\n\nexport type OctaveSolfegeRelative = {octaveOffset: number, solfege: SolfegeClass};\n\nexport type Note =  \n    {kind: \"solfege\", solfege: OctaveSolfegeRelative, tonic: Note}\n    | {kind: \"midi\", midi: number} \n    | ScientificNote;\n\nexport function solfegeNote(solfege: OctaveSolfegeRelative, tonic: Note): Note {\n    return {kind: \"solfege\", solfege: solfege, tonic: tonic};\n}\n\nexport function scientificNote(pitchClass: PitchClass, octave: Octave): Note {\n    return {kind: \"scientific\", class: pitchClass, octave: octave};\n}\n\nexport function midiToScientific(midi: number, octave: number): ScientificNote {\n    const c: PitchClass = midi % 12 == 9 ? \"A\"\n        : midi % 12 == 10 ? \"Bb\"\n        : midi % 12 == 11 ? \"B\"\n        : midi % 12 == 0 ? \"C\"\n        : midi % 12 == 1 ? \"Db\"\n        : midi % 12 == 2 ? \"D\"\n        : midi % 12 == 3 ? \"Eb\"\n        : midi % 12 == 4 ? \"E\"\n        : midi % 12 == 5 ? \"F\"\n        : midi % 12 == 6 ? \"F#\"\n        : midi % 12 == 7 ? \"G\"\n        : \"Ab\";\n\n    return { kind: \"scientific\", class: c, octave: octave as Octave }\n}\n\nexport function midiNote(midi: number): Note {\n    return {kind: \"midi\", midi: midi};\n}\n\nexport type MusicalPhrase = Note[][];\n\nexport const noteDropdownOptions = ['A', 'Bb', 'B', 'C', 'Db', 'D', 'Eb', 'E', 'F', 'F#', 'G', 'Ab'];\n\nexport const numberedNoteDropdownOptions: string[] = mapcat(\n    [1, 2, 3, 4, 5, 6, 7, 8],\n    num => noteDropdownOptions.map(letter => letter + num.toString())\n);\n\nexport function NoteToMidi(note: Note): MidiNote {\n    return note.kind == \"midi\" ? note.midi\n        : note.kind == \"scientific\" ? Frequency(note.class + note.octave.toString()).toMidi()\n        : offsetFromRoot(note.solfege.solfege) + 12 * note.solfege.octaveOffset + NoteToMidi(note.tonic);\n}\n\nexport function noteToHumanReadable(note: Note): string {\n    return Frequency(NoteToMidi(note), \"midi\").toNote();\n}\n\nexport type NoteComparison = \"greater\" | \"equal\" | \"lesser\"\nexport function compareNotes(n: Note, m: Note): NoteComparison {\n    const x = NoteToMidi(n); const y = NoteToMidi(m);\n    return x < y ? \"lesser\" : x > y ? \"greater\" : \"equal\";\n}\n\nexport function offsetFromRoot(solfege: SolfegeClass): number {\n    return solfege == \"do\" ? 0\n        : solfege == \"ra\" ? 1\n        : solfege == \"re\" ? 2\n        : solfege == \"ri\" ? 3\n        : solfege == \"me\" ? 3\n        : solfege == \"mi\" ? 4\n        : solfege == \"fa\" ? 5\n        : solfege == \"fi\" ? 6\n        : solfege == \"se\" ? 6\n        : solfege == \"so\" ? 7\n        : solfege == \"si\" ? 8\n        : solfege == \"le\" ? 8\n        : solfege == \"la\" ? 9\n        : solfege == \"li\" ? 10\n        : solfege == \"te\" ? 10\n        : solfege == \"ti\" ? 11\n        : -1; \n}\n\nexport function toSolfege(solfege: string): SolfegeClass {\n    if (offsetFromRoot(solfege as SolfegeClass) == -1) {\n        console.log(\"Not valid solfege: \" + solfege);\n        throw new Error(\"Invalid solfege: \" + solfege);\n    } else {\n        return solfege as SolfegeClass;\n    }\n}\n\n// just for ascending chords\nexport function toOctaveSolfege(solfege: SolfegeClass[]): OctaveSolfegeRelative[] {\n    let maxOffsetSoFar = -1;\n    let octave = 0;\n    const result: OctaveSolfegeRelative[] = [];\n\n    solfege.forEach(note => {\n        const baseOffset = offsetFromRoot(note) ?? 0;\n        while (baseOffset + octave * 12 <= maxOffsetSoFar) {\n            octave++;\n        }\n        const withOctave = baseOffset + 12 * octave;\n        maxOffsetSoFar = withOctave;\n        result.push({solfege: note, octaveOffset: octave});\n    });\n    return result;\n}","import { MidiNote, midiToScientific, Note, NoteToMidi, ScientificNote } from \"../models/notes\";\n\nexport type PlayedNote = {\n    velocity: number;\n    note: ScientificNote;\n    sustained: boolean;\n    timeFirstPresseddMilliseconds: number;\n    ageMilliseconds: number;\n    midiNote: MidiNote;\n}\n\nexport class MidiBatcher {\n    private _notes: Map<MidiNote, PlayedNote> = new Map<MidiNote, PlayedNote>();;\n    private _sustainOn = false;\n\n    constructor() { }\n\n    endSustain()\n    {\n        this._sustainOn = false;\n        const newNotes = new Map<MidiNote, PlayedNote>();\n        this._notes.forEach((n, k) => {\n            if (!n.sustained)\n                newNotes.set(k, n);\n        });\n        this._notes = newNotes;\n    }\n\n    beginSustain()\n    {\n        this._sustainOn = true;\n    }\n\n    handleNoteOn(note: MidiNote, octave: number, velocity: number): void\n    {\n        \n        this._notes.set(note, {velocity: velocity, note: midiToScientific(note, octave), midiNote: note,\n            sustained: false, timeFirstPresseddMilliseconds: performance.now(), ageMilliseconds: 0});\n    }\n\n    handleNoteOff(note: MidiNote): void\n    {\n        if (this._sustainOn)\n        {\n            const n = this._notes.get(note);\n            if (n != undefined)\n                n.sustained = true;\n        }\n        else\n        {\n            this._notes.delete(note);\n        }\n    }\n\n    getNotes(): PlayedNote[]\n    {\n        const notes = Array.from(this._notes.values());\n        notes.sort((a, b) => NoteToMidi(a.note) - NoteToMidi(b.note));\n        return notes;\n    }\n\n    tick(): void\n    {\n        const now = performance.now();\n        this._notes.forEach(n => n.ageMilliseconds = now - n.timeFirstPresseddMilliseconds);\n    }\n}","// https://github.com/bottosson/bottosson.github.io/blob/master/misc/colorpicker/colorconversion.js\n// Copyright (c) 2021 Bjrn Ottosson\n\n// Permission is hereby granted, free of charge, to any person obtaining a copy of\n// this software and associated documentation files (the \"Software\"), to deal in\n// the Software without restriction, including without limitation the rights to\n// use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies\n// of the Software, and to permit persons to whom the Software is furnished to do\n// so, subject to the following conditions:\n// The above copyright notice and this permission notice shall be included in all\n// copies or substantial portions of the Software.\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n// SOFTWARE.\n\n\nexport function hsl_to_rgb(h, s, l)\n{\n    let r, g, b;\n\n    if (s == 0)\n    {\n        r = g = b = l;\n    } \n    else \n    {\n        function hue_to_rgb(p, q, t)\n        {\n            if (t < 0) \n                t += 1;\n            if (t > 1) \n                t -= 1;\n            if (t < 1/6) \n                return p + (q - p) * 6 * t;\n            if (t < 1/2) \n                return q;\n            if (t < 2/3) \n                return p + (q - p) * (2/3 - t) * 6;\n            return p;\n        }\n\n        let q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n        let p = 2 * l - q;\n        r = hue_to_rgb(p, q, h + 1/3);\n        g = hue_to_rgb(p, q, h);\n        b = hue_to_rgb(p, q, h - 1/3);\n    }\n\n    return [r * 255, g * 255, b * 255];\n}\n\nfunction srgb_transfer_function(a) {\n    return .0031308 >= a ? 12.92 * a : 1.055 * Math.pow(a, .4166666666666667) - .055\n}\n\nfunction srgb_transfer_function_inv(a) {\n    return .04045 < a ? Math.pow((a + .055) / 1.055, 2.4) : a / 12.92\n}\n\nfunction linear_srgb_to_oklab(r,g,b) \n{\n    let l = 0.4122214708 * r + 0.5363325363 * g + 0.0514459929 * b;\n\tlet m = 0.2119034982 * r + 0.6806995451 * g + 0.1073969566 * b;\n\tlet s = 0.0883024619 * r + 0.2817188376 * g + 0.6299787005 * b;\n\n    let l_ = Math.cbrt(l);\n    let m_ = Math.cbrt(m);\n    let s_ = Math.cbrt(s);\n\n    return [\n        0.2104542553*l_ + 0.7936177850*m_ - 0.0040720468*s_,\n        1.9779984951*l_ - 2.4285922050*m_ + 0.4505937099*s_,\n        0.0259040371*l_ + 0.7827717662*m_ - 0.8086757660*s_,\n    ];\n}\n\nfunction oklab_to_linear_srgb(L,a,b) \n{\n \n    let l_ = L + 0.3963377774 * a + 0.2158037573 * b;\n    let m_ = L - 0.1055613458 * a - 0.0638541728 * b;\n    let s_ = L - 0.0894841775 * a - 1.2914855480 * b;\n\n    let l = l_*l_*l_;\n    let m = m_*m_*m_;\n    let s = s_*s_*s_;\n\n    return [\n\t\t(+4.0767416621 * l - 3.3077115913 * m + 0.2309699292 * s),\n\t\t(-1.2684380046 * l + 2.6097574011 * m - 0.3413193965 * s),\n\t\t(-0.0041960863 * l - 0.7034186147 * m + 1.7076147010 * s),\n    ];\n}\n\nfunction toe(x)\n{\n    const k_1 = 0.206\n    const k_2 = 0.03\n    const k_3 = (1+k_1)/(1+k_2)\n    \n    return 0.5*(k_3*x - k_1 + Math.sqrt((k_3*x - k_1)*(k_3*x - k_1) + 4*k_2*k_3*x))\n}\n\nfunction toe_inv(x)\n{\n    const k_1 = 0.206\n    const k_2 = 0.03\n    const k_3 = (1+k_1)/(1+k_2)\n    return (x*x + k_1*x)/(k_3*(x+k_2))\n}\n\n// Finds the maximum saturation possible for a given hue that fits in sRGB\n// Saturation here is defined as S = C/L\n// a and b must be normalized so a^2 + b^2 == 1\nfunction compute_max_saturation(a, b)\n{\n    // Max saturation will be when one of r, g or b goes below zero.\n\n    // Select different coefficients depending on which component goes below zero first\n    let k0, k1, k2, k3, k4, wl, wm, ws;\n\n    if (-1.88170328 * a - 0.80936493 * b > 1)\n    {\n        // Red component\n        k0 = +1.19086277; k1 = +1.76576728; k2 = +0.59662641; k3 = +0.75515197; k4 = +0.56771245;\n        wl = +4.0767416621; wm = -3.3077115913; ws = +0.2309699292;\n    }\n    else if (1.81444104 * a - 1.19445276 * b > 1)\n    {\n        // Green component\n        k0 = +0.73956515; k1 = -0.45954404; k2 = +0.08285427; k3 = +0.12541070; k4 = +0.14503204;\n        wl = -1.2684380046; wm = +2.6097574011; ws = -0.3413193965;\n    }\n    else\n    {\n        // Blue component\n        k0 = +1.35733652; k1 = -0.00915799; k2 = -1.15130210; k3 = -0.50559606; k4 = +0.00692167;\n        wl = -0.0041960863; wm = -0.7034186147; ws = +1.7076147010;\n    }\n\n    // Approximate max saturation using a polynomial:\n    let S = k0 + k1 * a + k2 * b + k3 * a * a + k4 * a * b;\n\n    // Do one step Halley's method to get closer\n    // this gives an error less than 10e6, except for some blue hues where the dS/dh is close to infinite\n    // this should be sufficient for most applications, otherwise do two/three steps \n\n    let k_l = +0.3963377774 * a + 0.2158037573 * b;\n    let k_m = -0.1055613458 * a - 0.0638541728 * b;\n    let k_s = -0.0894841775 * a - 1.2914855480 * b;\n\n    {\n        let l_ = 1 + S * k_l;\n        let m_ = 1 + S * k_m;\n        let s_ = 1 + S * k_s;\n\n        let l = l_ * l_ * l_;\n        let m = m_ * m_ * m_;\n        let s = s_ * s_ * s_;\n\n        let l_dS = 3 * k_l * l_ * l_;\n        let m_dS = 3 * k_m * m_ * m_;\n        let s_dS = 3 * k_s * s_ * s_;\n\n        let l_dS2 = 6 * k_l * k_l * l_;\n        let m_dS2 = 6 * k_m * k_m * m_;\n        let s_dS2 = 6 * k_s * k_s * s_;\n\n        let f  = wl * l     + wm * m     + ws * s;\n        let f1 = wl * l_dS  + wm * m_dS  + ws * s_dS;\n        let f2 = wl * l_dS2 + wm * m_dS2 + ws * s_dS2;\n\n        S = S - f * f1 / (f1*f1 - 0.5 * f * f2);\n    }\n\n    return S;\n}\n\nfunction find_cusp(a, b)\n{\n\t// First, find the maximum saturation (saturation S = C/L)\n\tlet S_cusp = compute_max_saturation(a, b);\n\n\t// Convert to linear sRGB to find the first point where at least one of r,g or b >= 1:\n\tlet rgb_at_max = oklab_to_linear_srgb(1, S_cusp * a, S_cusp * b);\n\tlet L_cusp = Math.cbrt(1 / Math.max(Math.max(rgb_at_max[0], rgb_at_max[1]), rgb_at_max[2]));\n\tlet C_cusp = L_cusp * S_cusp;\n\n\treturn [ L_cusp , C_cusp ];\n}\n\n// Finds intersection of the line defined by \n// L = L0 * (1 - t) + t * L1;\n// C = t * C1;\n// a and b must be normalized so a^2 + b^2 == 1\nfunction find_gamut_intersection(a, b, L1, C1, L0, cusp=null)\n{\n    if (!cusp)\n    {\n        // Find the cusp of the gamut triangle\n        cusp = find_cusp(a, b);\n    }\n\n\t// Find the intersection for upper and lower half seprately\n\tlet t;\n\tif (((L1 - L0) * cusp[1] - (cusp[0] - L0) * C1) <= 0)\n\t{\n\t\t// Lower half\n\n\t\tt = cusp[1] * L0 / (C1 * cusp[0] + cusp[1] * (L0 - L1));\n\t}\n\telse\n\t{\n\t\t// Upper half\n\n\t\t// First intersect with triangle\n\t\tt = cusp[1] * (L0 - 1) / (C1 * (cusp[0] - 1) + cusp[1] * (L0 - L1));\n\n\t\t// Then one step Halley's method\n\t\t{\n\t\t\tlet dL = L1 - L0;\n\t\t\tlet dC = C1;\n\n\t\t\tlet k_l = +0.3963377774 * a + 0.2158037573 * b;\n\t\t\tlet k_m = -0.1055613458 * a - 0.0638541728 * b;\n\t\t\tlet k_s = -0.0894841775 * a - 1.2914855480 * b;\n\n\t\t\tlet l_dt = dL + dC * k_l;\n\t\t\tlet m_dt = dL + dC * k_m;\n\t\t\tlet s_dt = dL + dC * k_s;\n\n\t\t\t\n\t\t\t// If higher accuracy is required, 2 or 3 iterations of the following block can be used:\n\t\t\t{\n\t\t\t\tlet L = L0 * (1 - t) + t * L1;\n\t\t\t\tlet C = t * C1;\n\n\t\t\t\tlet l_ = L + C * k_l;\n\t\t\t\tlet m_ = L + C * k_m;\n\t\t\t\tlet s_ = L + C * k_s;\n\n\t\t\t\tlet l = l_ * l_ * l_;\n\t\t\t\tlet m = m_ * m_ * m_;\n\t\t\t\tlet s = s_ * s_ * s_;\n\n\t\t\t\tlet ldt = 3 * l_dt * l_ * l_;\n\t\t\t\tlet mdt = 3 * m_dt * m_ * m_;\n\t\t\t\tlet sdt = 3 * s_dt * s_ * s_;\n\n\t\t\t\tlet ldt2 = 6 * l_dt * l_dt * l_;\n\t\t\t\tlet mdt2 = 6 * m_dt * m_dt * m_;\n\t\t\t\tlet sdt2 = 6 * s_dt * s_dt * s_;\n\n\t\t\t\tlet r = 4.0767416621 * l - 3.3077115913 * m + 0.2309699292 * s - 1;\n\t\t\t\tlet r1 = 4.0767416621 * ldt - 3.3077115913 * mdt + 0.2309699292 * sdt;\n\t\t\t\tlet r2 = 4.0767416621 * ldt2 - 3.3077115913 * mdt2 + 0.2309699292 * sdt2;\n\n\t\t\t\tlet u_r = r1 / (r1 * r1 - 0.5 * r * r2);\n\t\t\t\tlet t_r = -r * u_r;\n\n\t\t\t\tlet g = -1.2684380046 * l + 2.6097574011 * m - 0.3413193965 * s - 1;\n\t\t\t\tlet g1 = -1.2684380046 * ldt + 2.6097574011 * mdt - 0.3413193965 * sdt;\n\t\t\t\tlet g2 = -1.2684380046 * ldt2 + 2.6097574011 * mdt2 - 0.3413193965 * sdt2;\n\n\t\t\t\tlet u_g = g1 / (g1 * g1 - 0.5 * g * g2);\n\t\t\t\tlet t_g = -g * u_g;\n\n\t\t\t\tlet b = -0.0041960863 * l - 0.7034186147 * m + 1.7076147010 * s - 1;\n\t\t\t\tlet b1 = -0.0041960863 * ldt - 0.7034186147 * mdt + 1.7076147010 * sdt;\n\t\t\t\tlet b2 = -0.0041960863 * ldt2 - 0.7034186147 * mdt2 + 1.7076147010  * sdt2;\n\n\t\t\t\tlet u_b = b1 / (b1 * b1 - 0.5 * b * b2);\n\t\t\t\tlet t_b = -b * u_b;\n\n\t\t\t\tt_r = u_r >= 0 ? t_r : 10e5;\n\t\t\t\tt_g = u_g >= 0 ? t_g : 10e5;\n\t\t\t\tt_b = u_b >= 0 ? t_b : 10e5;\n\n\t\t\t\tt += Math.min(t_r, Math.min(t_g, t_b));\n\t\t\t}\n\t\t}\n\t}\n\n\treturn t;\n}\n\nfunction get_ST_max(a_,b_, cusp=null)\n{\n    if (!cusp)\n    {\n        cusp = find_cusp(a_, b_);\n    }\n\n    let L = cusp[0];\n    let C = cusp[1];\n    return [C/L, C/(1-L)];\n}\n\nfunction get_ST_mid(a_,b_)\n{\n    S = 0.11516993 + 1/(\n        + 7.44778970 + 4.15901240*b_\n        + a_*(- 2.19557347 + 1.75198401*b_\n        + a_*(- 2.13704948 -10.02301043*b_ \n        + a_*(- 4.24894561 + 5.38770819*b_ + 4.69891013*a_\n        )))\n    );\n\n    T = 0.11239642 + 1/(\n        + 1.61320320 - 0.68124379*b_\n        + a_*(+ 0.40370612 + 0.90148123*b_\n        + a_*(- 0.27087943 + 0.61223990*b_ \n        + a_*(+ 0.00299215 - 0.45399568*b_ - 0.14661872*a_\n        )))\n    );\n\n    return [S, T];\n}\n\nfunction get_Cs(L, a_, b_)\n{\n    let cusp = find_cusp(a_, b_);\n\n    let C_max = find_gamut_intersection(a_,b_,L,1,L,cusp);\n    let ST_max = get_ST_max(a_, b_, cusp);\n\n    let S_mid = 0.11516993 + 1/(\n        + 7.44778970 + 4.15901240*b_\n        + a_*(- 2.19557347 + 1.75198401*b_\n        + a_*(- 2.13704948 -10.02301043*b_ \n        + a_*(- 4.24894561 + 5.38770819*b_ + 4.69891013*a_\n        )))\n    );\n\n    let T_mid = 0.11239642 + 1/(\n        + 1.61320320 - 0.68124379*b_\n        + a_*(+ 0.40370612 + 0.90148123*b_\n        + a_*(- 0.27087943 + 0.61223990*b_ \n        + a_*(+ 0.00299215 - 0.45399568*b_ - 0.14661872*a_\n        )))\n    );\n\n    let k = C_max/Math.min((L*ST_max[0]), (1-L)*ST_max[1]);\n\n    let C_mid;\n    {\n        let C_a = L*S_mid;\n        let C_b = (1-L)*T_mid;\n\n        C_mid = 0.9*k*Math.sqrt(Math.sqrt(1/(1/(C_a*C_a*C_a*C_a) + 1/(C_b*C_b*C_b*C_b))));\n    }\n\n    let C_0;\n    {\n        let C_a = L*0.4;\n        let C_b = (1-L)*0.8;\n\n        C_0 = Math.sqrt(1/(1/(C_a*C_a) + 1/(C_b*C_b)));\n    }\n\n    return [C_0, C_mid, C_max];\n}\n\nexport function okhsl_to_srgb(h,s,l)\n{\n    if (l == 1)\n    {\n        return [255,255,255];\n    }\n\n    else if (l == 0)\n    {\n        return [0,0,0];\n    }\n\n    let a_ = Math.cos(2*Math.PI*h);\n    let b_ = Math.sin(2*Math.PI*h);   \n    let L = toe_inv(l);\n\n    let Cs = get_Cs(L, a_, b_);\n    let C_0 = Cs[0];\n    let C_mid = Cs[1];\n    let C_max = Cs[2];\n\n    let C, t, k_0, k_1, k_2;\n    if (s < 0.8)\n    {   \n        t = 1.25*s;\n        k_0 = 0;\n        k_1 = 0.8*C_0;\n        k_2 = (1-k_1/C_mid);\n    }\n    else\n    {\n        t = 5*(s-0.8);\n        k_0 = C_mid;\n        k_1 = 0.2*C_mid*C_mid*1.25*1.25/C_0;\n        k_2 = (1 - (k_1)/(C_max - C_mid));\n    }\n\n    C = k_0 + t*k_1/(1-k_2*t);\n\n    // If we would only use one of the Cs:\n    //C = s*C_0;\n    //C = s*1.25*C_mid;\n    //C = s*C_max;\n\n    let rgb = oklab_to_linear_srgb(L, C*a_, C*b_);\n    return [\n        255*srgb_transfer_function(rgb[0]),\n        255*srgb_transfer_function(rgb[1]),\n        255*srgb_transfer_function(rgb[2]),\n    ]\n}\n\n\nexport function hex_to_rgb(hex)\n{\n    if (hex.substr(0,1) == \"#\")\n        hex = hex.substr(1);\n\n    if (hex.match(/^([0-9a-f]{3})$/i)) \n    {\n        let r = parseInt(hex.charAt(0),16)/15 * 255;\n        let g = parseInt(hex.charAt(1),16)/15 * 255;\n        let b = parseInt(hex.charAt(2),16)/15 * 255;\n        return [r,g,b];\n    }\n    if (hex.match(/^([0-9a-f]{6})$/i)) \n    {\n        let r = parseInt(hex.substr(0,2),16);\n        let g = parseInt(hex.substr(2,2),16);\n        let b = parseInt(hex.substr(4,2),16);\n        return [r,g,b];\n    }\n    if (hex.match(/^([0-9a-f]{1})$/i)) \n    {\n        let a = parseInt(hex.substr(0),16)/15 * 255;\n        return [a,a,a];\n    }\n    if (hex.match(/^([0-9a-f]{2})$/i)) \n    {\n        let a = parseInt(hex.substr(0,2),16);\n        return [a,a,a];\n    }\n\n    return null;\n}\n\nexport function rgb_to_hex(r,g,b)\n{\n    function componentToHex(x) \n    {\n        var hex = Math.round(x).toString(16);\n        return hex.length == 1 ? \"0\" + hex : hex;\n    }\n\n    return \"#\" + componentToHex(r) + componentToHex(g) + componentToHex(b); \n}","import { PitchClass, NoteToMidi, midiNote } from \"../models/notes\";\nimport { MixBias, OvertoneConfig, CircleConfig, ColorConfig } from \"../models/options\";\nimport { PlayedNote } from \"./midiBatcher\";\nimport { okhsl_to_srgb, hsl_to_rgb, rgb_to_hex } from \"../colorconversion\"\n\nexport type WeightedHSL = {\n    weight: number; // between [0, 1], in a list of  WeightedHSL, they sum to 1.\n    color: HSL;\n}\n\nexport type HSLType = \"standard\" | \"okhsl\";\n\nexport type HSL = {\n    hue: number; // [0, 360], int\n    saturation: number; // [0, 100], float\n    light: number; // [0, 100], float\n    kind: HSLType;\n}\n\nexport interface RGB {\n    red: number;\n    green: number;\n    blue: number;\n}\n\nexport interface RGBA {\n    red: number;\n    green: number;\n    blue: number;\n    alpha: number;\n}\n\nexport type HexColor = string;\n\nexport function hslToRGB(color: HSL): RGBA {\n    if (color.kind == \"standard\") {\n        return hslToRgbHelper(color);\n    } else if (color.kind == \"okhsl\") {\n        const r = okhsl_to_srgb(color.hue / 360, color.saturation / 100, color.light / 100);\n        return { red: r[0], green: r[1], blue: r[2], alpha: 255};\n    } else {\n        throw \"\";\n    }\n}\n\n/**\n * Converts an HSL color value to RGB. Conversion formula\n * adapted from http://en.wikipedia.org/wiki/HSL_color_space.\n * Assumes h, s, and l are contained in the set [0, 1] and\n * returns r, g, and b in the set [0, 255].\n *\n * @param   {number}  h       The hue\n * @param   {number}  s       The saturation\n * @param   {number}  l       The lightness\n * @return  {Array}           The RGB representation\n * \n * https://stackoverflow.com/a/9493060\n */\nfunction hslToRgbHelper(hsl: HSL): RGBA {\n    const h = hsl.hue / 360.0;\n    const l = hsl.light / 100.0;\n    const s = hsl.saturation / 100.0;\n\n    let r, g, b;\n\n    if(s == 0){\n        r = g = b = l; // achromatic\n    }else{\n        const hue2rgb = function hue2rgb(p: number, q: number, t: number){\n            if(t < 0) t += 1;\n            if(t > 1) t -= 1;\n            if(t < 1/6) return p + (q - p) * 6 * t;\n            if(t < 1/2) return q;\n            if(t < 2/3) return p + (q - p) * (2/3 - t) * 6;\n            return p;\n        }\n\n        const q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n        const p = 2 * l - q;\n        r = hue2rgb(p, q, h + 1/3);\n        g = hue2rgb(p, q, h);\n        b = hue2rgb(p, q, h - 1/3);\n    }\n\n    return {red: Math.round(r * 255), green: Math.round(g * 255), blue: Math.round(b * 255), alpha: 255};\n}\n\n// https://stackoverflow.com/a/44134328\nexport function hslToHex(hsl: HSL): HexColor {\n    const rgb = hslToRGB(hsl);\n    return rgb_to_hex(rgb.red, rgb.green, rgb.blue);\n}\n\nconst fifths: Map<PitchClass, number> = new Map<PitchClass, number>(\n    [\n        [\"C\", 0],\n        [\"G\", 30],  \n        [\"D\", 60],  \n        [\"A\", 90],  \n        [\"E\", 120],  \n        [\"B\", 150],  \n        [\"F#\", 180],  \n        [\"Db\", 210],  \n        [\"Ab\", 240],  \n        [\"Eb\", 270],  \n        [\"Bb\", 300],  \n        [\"F\", 330]\n    ]\n);\n\n// lifespanFactor:  lifespan is ms, this is multiplied by ms to get percentage discount.\n// for -5% every second, do 0.05/1000\nexport function notesToColors(config: CircleConfig, colorConfig: ColorConfig, notes: PlayedNote[]): HSL[] {\n    const kind: HSLType = colorConfig.okHSL ? \"okhsl\" : \"standard\";\n    return notes.map(pn =>\n        {\n            const noteNumber = NoteToMidi(pn.note) - 21;\n            // between 0, 100 -- a percentage\n            return {\n                hue: Math.abs((360 - fifths.get(pn.note.class)! + config.degreeOffset + fifths.get(config.tonic)!)) % 360,\n                saturation: (88 - noteNumber) * ((colorConfig.saturationCeiling - colorConfig.saturationFloor) / 88) + colorConfig.saturationFloor, // * pn.velocity, \n                light: noteNumber * ((colorConfig.lightCeiling - colorConfig.lightFloor) / 88.0) + colorConfig.lightFloor,\n                kind: kind\n            };\n        });\n}\n\ntype Vector = {x: number; y: number; z: number}\nfunction hslToVector(hsl: HSL): Vector {\n    // https://stackoverflow.com/a/53328189\n    return {\n        x: Math.cos(hsl.hue / 180 * Math.PI) * hsl.saturation,\n        y: Math.sin(hsl.hue / 180 * Math.PI) * hsl.saturation,\n        z: hsl.light\n    };\n}\n\nfunction vectorToHsl(v: Vector, type: HSLType): HSL {\n    const h = Math.atan2(v.y, v.x) * 180 / Math.PI;\n    return {\n        hue: h < 0 ? 360 + h : h,\n        saturation : Math.sqrt(v.x * v.x + v.y * v.y),\n        light: v.z,\n        kind: type\n    };\n}\n\nexport function mixColors(biases: MixBias, colors: HSL[], velocities: number[]): HSL {\n    if (colors.length == 1)\n    {\n        return colors[0];\n    }\n    const middleCount = colors.length - 2;\n    let totalDivider = 0;\n\n    // todo: also weight by velocity?\n    const v = { x: 0, y: 0, z: 0};\n    for (let i = 0; i < colors.length; i++)\n    {\n        let weight = i == 0 ? biases.rootBias\n            : i == colors.length - 1 ? biases.melodyBias\n            : 1;\n        weight *= biases.considerVelocity ? velocities[i] : 1;\n        totalDivider += weight;\n\n\n        const cv = hslToVector(colors[i]);\n        v.x += cv.x * weight;\n        v.y += cv.y * weight;\n        v.z += cv.z * weight;\n    }\n\n    v.x /= totalDivider;\n    v.y /= totalDivider;\n    v.z /= totalDivider;\n\n    return vectorToHsl(v, colors[0].kind);\n}\n\n// todo: use light and sat floor/ceiling here\nexport function colorOvertones(color: HSL, config: OvertoneConfig): WeightedHSL[] {\n    const make = (h: number, semitones: number) => ({hue: h, light: lighten(semitones), saturation: desaturate(semitones), kind: color.kind});\n    const lighten = (semitones: number) => Math.min(100, (100/88) * semitones + color.light);\n    const desaturate = (semitones: number) => Math.max(0, color.saturation - (100 / 88) * semitones);\n\n    let counter = 1;\n\n    const result: WeightedHSL[] = [{ color: color, weight: 1 } ];\n\n    const addOvertone = (c: HSL) => {\n        counter++;\n        const thisWeight = 1 / (config.backoffCoefficient * counter);\n        result.push({color: c, weight: thisWeight});\n    }\n\n    // addition and subtraction are opposites because we need to move counterclockwise\n    // around HSL. So, sharp: subtract; flat: add\n    if (config.numberOvertones >= 1)\n        addOvertone(make(color.hue, 12));\n    if (config.numberOvertones >= 2)\n        addOvertone(make(color.hue - 31, 19)); // octave and a fifth that's 2cents sharp\n    if (config.numberOvertones >= 3) \n        addOvertone(make(color.hue, 24));\n    if (config.numberOvertones >= 4)\n        addOvertone(make((color.hue - 120 + 15 * 14/50) %  360, 28)); // major third that's 14 cents flat\n    if (config.numberOvertones >= 5)\n        addOvertone(make(color.hue - 31, 31));\n    if (config.numberOvertones >= 6)\n        addOvertone(make((color.hue + 60 + 15 * 31/50) % 360, 34)); // minor seventh 31 cents flat\n\n    normalizeWeights(result);\n\n    return result;\n}\n\nexport function normalizeWeights(weightedColors: WeightedHSL[]) {\n    const totalWeight = weightedColors.map(wc => wc.weight).reduce((x, y) => x + y, 0);\n    weightedColors.forEach(wc => wc.weight /= totalWeight);\n}","import { Options, defaultOptions, CanvasOptions, OvertoneConfig, WheelViewModeConfig, CircleConfig, MixBias, RenderBias, DecayConfig, ColorConfig } from '../domain/models/options';\nimport { Note, NoteToMidi, scientificNote, Octave, PitchClass, midiToScientific } from \"../domain/models/notes\";\nimport { MidiBatcher } from \"../domain/services/midiBatcher\";\nimport { HSL, RGB, RGBA, notesToColors, hslToHex, mixColors, HexColor, hslToRGB, colorOvertones, normalizeWeights } from \"../domain/services/colorGiver\";\nimport { indexBy, deepMap, flipMap, drawRandom } from \"../domain/util/util\";\n\nexport type RandomPixelatorConfig = {circleConfig: CircleConfig; mixConfig: MixBias; renderConfig: RenderBias; overtoneConfig: OvertoneConfig; decayConfig: DecayConfig; colorConfig: ColorConfig }\nexport type RandomPixelator = (midiBatcher: MidiBatcher,config: RandomPixelatorConfig, tryClear: (() => void)) => void\nexport const doNothingRandomPixelator: RandomPixelator = (a, b, c) => {}\n\nexport function makeRandomPixelatorConfig(config: Options): RandomPixelatorConfig {\n    return { circleConfig: config.circle, mixConfig: config.mix, renderConfig: config.render, overtoneConfig: config.overtone, decayConfig: config.decay, colorConfig: config.color }\n};\n\nexport function makeRandomPixelator(ctx: CanvasRenderingContext2D, dimensions: CanvasOptions): RandomPixelator\n{\n    const width = dimensions.width;\n    const height = dimensions.height;\n\n    const arr = new Uint8ClampedArray(width * height * 4);\n    const imageData = new ImageData(arr, width);\n    return (midiBatcher, config, tryClear)  =>\n    {\n        const rgbs = generateRGBs(midiBatcher, config);\n        if (rgbs.length == 0)\n            tryClear();\n\n        else\n        {\n            // const loopTimeStart = performance.now();\n            for (let i = 0; i < arr.length; i+=4)\n            {\n                const c = rgbs[Math.floor(Math.random()*rgbs.length)];\n                arr[i] = c.red;\n                arr[i + 1] = c.green;\n                arr[i + 2] = c.blue;\n                arr[i + 3] = c.alpha;\n            }\n            // const loopTimeEnd = performance.now();\n            // console.log(\"loop time: \" + (loopTimeEnd - loopTimeStart));\n\n            ctx.putImageData(imageData, 0, 0);\n        }\n    }\n}\n\nfunction generateRGBs(midiBatcher: MidiBatcher, config: RandomPixelatorConfig): RGBA[] {\n    const notes = midiBatcher.getNotes();\n    const velocities = notes.map(n => n.velocity);\n    const rawColors = notesToColors(config.circleConfig, config.colorConfig, notes);\n    if (rawColors.length == 0)\n        return [];\n    else\n    {\n        // first, weight with overtones, then weight with root/middle/etc. etc.?\n        const cs = [... rawColors];\n        if (cs.length > 1)\n            cs.push(mixColors(config.mixConfig, cs, velocities));\n        const withOvertones = cs.map(c => colorOvertones(c, config.overtoneConfig));\n        for (let i = 0; i < withOvertones.length; i++)\n        {\n            if (i == 0)\n                withOvertones[i].forEach(wc => wc.weight *= config.renderConfig.rootBias);\n            else if (i == withOvertones.length - 1)\n                withOvertones[i].forEach(wc => wc.weight *= config.renderConfig.emergentBias);\n            else if (i == withOvertones.length - 2)\n                withOvertones[i].forEach(wc => wc.weight *= config.renderConfig.melodyBias);\n            else \n                withOvertones[i].forEach(wc => wc.weight *= config.renderConfig.middleBias);\n        }\n        const flatColors = withOvertones.flat();\n        normalizeWeights(flatColors);\n        const drawingPool: RGBA[] = [];\n        flatColors.forEach(wc => {\n            const rgb = {... hslToRGB(wc.color), alpha: 255};\n            for (let i = 0; i < Math.floor(10000 * wc.weight); i++)\n                drawingPool.push(rgb);\n        });\n\n        return drawingPool;\n    }\n}","import { RGBA } from \"@/domain/services/colorGiver\";\n\nexport type Box = { width: number; height: number; xOrigin: number; yOrigin: number; }\n\nexport type BoxedImage = { box: Box; image: ImageData; }\n\nexport function drawBoxedImage(ctx: CanvasRenderingContext2D, boxedImage: BoxedImage ) {\n    ctx.putImageData(boxedImage.image, boxedImage.box.xOrigin, boxedImage.box.yOrigin);\n}\n\n// percent: between 0 and 1, % along the way to draw the split line.\n// same as the % that the left box will have.\n// returns [left, right]\nexport function splitVertical(box: Box, percent: number): [Box, Box] {\n    const leftWidth = Math.floor(box.width * percent) - 1;\n    const rightWidth = Math.ceil(box.width * (1 - percent)) - 1;\n    const leftBox = { width: leftWidth, height: box.height, xOrigin: box.xOrigin, yOrigin: box.yOrigin};\n    const rightBox = { width: rightWidth, height: box.height, xOrigin: box.xOrigin + leftWidth, yOrigin: box.yOrigin};\n    return [leftBox, rightBox];\n}\n\n// return [top, bottom]\nexport function splitHorizontal(box: Box, percent: number): [Box, Box] {\n    const topHeight = Math.floor(box.height * percent);\n    const bottomHeight = Math.ceil(box.height * (1 - percent));\n    const topBox = { width: box.width, height: topHeight, xOrigin: box.xOrigin, yOrigin: box.yOrigin };\n    const bottomBox = { width: box.width, height: bottomHeight, xOrigin: box.xOrigin, yOrigin: box.yOrigin + topHeight};\n    return [topBox, bottomBox];\n}\n\nexport type PixelFn = (x: number, y: number) => RGBA\n\nexport function makeBoxedImage(box: Box, pixelFn: PixelFn): BoxedImage {\n    const arr = new Uint8ClampedArray(box.width * box.height * 4);\n    const imgData = new ImageData(arr, box.width);\n    for (let y = 0; y < box.height; y++) {\n        const ywidth = y*box.width;\n        for (let x = 0; x < box.width; x++) {\n            const i4 = 4 * (x + ywidth);\n            const rgb = pixelFn(x, y);\n            arr[i4] = rgb.red;\n            arr[i4 + 1] = rgb.green;\n            arr[i4 + 2] = rgb.blue;\n            arr[i4 + 3] = rgb.alpha;\n        }\n    }\n    return {box: box, image: imgData};\n}","\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Watch } from \"vue-property-decorator\";\nimport OptionsEditor from \"./components/OptionsEditor.vue\";\nimport { VBtn, VContainer, VRow, VCol, VTabs, VApp, VMain, VTabItem, VTab } from \"vuetify/lib\";\n\nimport { Options, defaultOptions, CanvasOptions, OvertoneConfig, WheelViewModeConfig } from './domain/models/options';\nimport { Note, NoteToMidi, scientificNote, Octave, PitchClass, midiToScientific } from \"./domain/models/notes\";\nimport { MidiBatcher } from \"./domain/services/midiBatcher\";\nimport { HSL, RGB, notesToColors, hslToHex, mixColors, HexColor, colorOvertones, hslToRGB, normalizeWeights, HSLType } from \"./domain/services/colorGiver\";\nimport { indexBy, deepMap, flipMap, drawRandom } from \"./domain/util/util\";\nimport webmidi, { WebMidi } from \"webmidi\";\nimport { RandomPixelator, makeRandomPixelator, RandomPixelatorConfig, doNothingRandomPixelator, makeRandomPixelatorConfig } from \"./drawers/RandomPixelator\"\nimport { Box, BoxedImage, drawBoxedImage, makeBoxedImage, splitVertical, splitHorizontal } from \"./drawers/drawing\";\n\ntype ColorWheelDrawer = (hslsWithOvertones: HSL[][], config: Options, degreeOffset: number) => void;\n\n@Component ({\n  components: {\n    OptionsEditor,\n    VApp, VMain,\n    VTabs, VTab, VTabItem,\n    VContainer, VRow, VCol,\n    VBtn\n  }\n})\n\nexport default class App extends Vue {\n\n  private options: Options = defaultOptions;\n  private midiBatcher: MidiBatcher = new MidiBatcher();\n  // private randomPixelator: (rgbs: RGB[]) => void = (x) => {}\n  private ctx: (CanvasRenderingContext2D | undefined) = undefined;\n\n  private randomPixelator: RandomPixelator = doNothingRandomPixelator;\n\n  private concentricPixelator = (rgbs: RGB[][], emergent: RGB[], emergentBias: number, emergentBiasFloor: number, vs: number[] | undefined) => {};\n\n  private wheelDrawer: ColorWheelDrawer = (hsls: HSL[][], c: Options) => {} \n\n  resize() {\n      this.options.canvas.width = window.innerWidth;\n      this.options.canvas.height = window.innerHeight;\n      this.randomPixelator = makeRandomPixelator(this.ctx!, this.options.canvas);\n      this.concentricPixelator = this.makeConcentricPixelator(this.ctx!, this.options.canvas);\n      this.wheelDrawer = this.makeColorWheelDrawer(this.ctx!, {width: this.options.canvas.width, height: this.options.canvas.height, xOrigin: 0, yOrigin: 0 });\n  }\n\n  created() {\n    window.addEventListener(\"resize\", this.resize);\n  }\n  \n  destroyed() {\n    window.removeEventListener(\"resize\", this.resize);\n  }\n\n  drawAll(ctx: CanvasRenderingContext2D, colors: HexColor[][], dimensions: Box)\n  {\n    const height = dimensions.height;\n    const width = dimensions.width;\n\n    const rows = colors.length;\n    const rowSize = height / rows;\n    for (let r = 0; r < rows; r++)\n    {\n      const colorsInRow = colors[r];\n      const cols = colorsInRow.length;\n      const colSize = width / cols;\n\n      for (let c = 0; c < cols; c++)\n      {\n        const thisColor = colorsInRow[c];\n        ctx.beginPath();\n        ctx.fillStyle = thisColor;\n        ctx.rect(c * colSize + dimensions.xOrigin, r * rowSize + dimensions.yOrigin, colSize, rowSize);\n        ctx.fill();\n      }\n    }\n  }\n\n  makeLightColorWheel(hslKind: HSLType, box: Box, degreeOffset: number) {\n    const centerX = box.width / 2;\n    const centerY = box.height / 2;\n    const radius = Math.min(box.width, box.height) / 2;\n    console.log(box, centerX, centerY, radius);\n\n    return makeBoxedImage(box, (x: number, y: number) => {\n          const dist = Math.sqrt((x - centerX) * (x - centerX) + (y - centerY) * (y - centerY));\n          if (dist < radius)\n          {\n            const theta = (Math.atan2(y - centerY, x - centerX) * (180/ Math.PI) + 360 + 90) % 360;\n            const hsl = { hue: (360 - theta + degreeOffset) % 360, saturation: 100, light: 100 * dist / radius, kind: hslKind }\n            return hslToRGB(hsl);\n          }\n          else\n          {\n            return {red: 0, green: 0, blue: 0, alpha: 0};\n          }\n        }\n    );\n  }\n\n  makeSaturatedColorWheel(hslKind: HSLType, box: Box, degreeOffset: number) {\n    const centerX = box.width / 2\n    const centerY = box.height / 2\n    const radius = Math.min(box.width, box.height) / 2;\n\n    return makeBoxedImage(box, (x: number, y: number) => {\n          const dist = Math.sqrt((x - centerX) * (x - centerX) + (y - centerY) * (y - centerY));\n          if (dist < radius)\n          {\n            const theta = (Math.atan2(y - centerY, x - centerX) * (180/ Math.PI) + 360 + 90) % 360;\n            const hsl = { hue: (360 - theta + degreeOffset) % 360, saturation: 100 * dist / radius, light: 50, kind: hslKind }\n            return hslToRGB(hsl);\n          }\n          else\n          {\n            return {red: 0, green: 0, blue: 0, alpha: 0};\n          }\n        }\n    );\n  }\n\n  makeColorWheelDrawer(ctx: CanvasRenderingContext2D, box: Box): ColorWheelDrawer\n  {\n    let lightCircleImage: BoxedImage | undefined = undefined;\n    let satCircleImage: BoxedImage | undefined = undefined;\n    let arrayInitializedWithKind: HSLType | undefined = undefined;\n\n    const [circleBoxes, gridBox] = splitHorizontal(box, 0.85);\n    const [lightCircleBox, satCircleBox] = splitVertical(circleBoxes, 0.5);\n    console.log(lightCircleBox, satCircleBox);\n\n    return (hsls: HSL[][], allConfig: Options, degreeOffset: number) =>\n    {\n      const config = allConfig.wheelViewModeConfig;\n      const hslKind: HSLType = allConfig.color.standardHSL ? \"standard\": \"okhsl\";\n\n      if (arrayInitializedWithKind == undefined || arrayInitializedWithKind !== hslKind)\n      {\n        lightCircleImage = this.makeLightColorWheel(hslKind, lightCircleBox, degreeOffset);\n        satCircleImage = this.makeSaturatedColorWheel(hslKind, satCircleBox, degreeOffset);\n        arrayInitializedWithKind = hslKind;\n      }\n\n      drawBoxedImage(ctx, lightCircleImage!);\n      drawBoxedImage(ctx, satCircleImage!);\n\n      const drawNoteInBox = (box: Box, hsl: HSL, i: number, magFn: (hsl: HSL) => number, isEmergent: boolean) => {\n        const centerX = box.width / 2 + box.xOrigin;\n        const centerY = box.height / 2 + box.yOrigin;\n        const radius = Math.min(box.width, box.height) / 2;\n\n        const spotlightSize = Math.floor(radius * config.spotlightScaleFactor  / (i + 1));\n        // const theta = 360 - ((hsl.hue - 90) * Math.PI / 180) % 360;\n        const theta = ((360 - hsl.hue - 90 + degreeOffset) % 360) * Math.PI / 180;\n        const magnitude = magFn(hsl) * radius / 100;\n        const x = magnitude * Math.cos(theta);\n        const y = magnitude * Math.sin(theta);\n        ctx.lineWidth = isEmergent ? config.lineWidth * 2 : config.lineWidth;\n        ctx.beginPath();\n        ctx.arc(x + centerX, y + centerY, isEmergent ? spotlightSize * 1.5 : spotlightSize, 0, Math.PI * 2);\n        ctx.strokeStyle = hslToHex({hue: (hsl.hue + 180) % 360, saturation: 100 - hsl.saturation, light: 100 - hsl.light, kind: hslKind});\n        ctx.fillStyle = hslToHex(hsl);\n        ctx.stroke();\n        ctx.fill();\n      }\n\n      ctx.clearRect(gridBox.xOrigin, gridBox.yOrigin, gridBox.width, gridBox.height);\n\n      if (config.showOvertones)\n      {\n        this.drawAll(ctx, deepMap(hsls, hslToHex), gridBox);\n      } else\n      {\n        this.drawAll(ctx, [hsls.map(hs => hslToHex(hs[0]))], gridBox);\n      }\n\n      for (let j = 0; j < hsls.length; j++)\n      {\n        if (config.showEmergentOnly && j != hsls.length - 1)\n          continue;\n\n        if (!config.showEmergence && j == hsls.length - 1)\n          continue;\n\n        const hslWithOvertones = hsls[j];\n\n        // ctx.beginPath();\n        // ctx.fillStyle = hslToHex(hslWithOvertones[0]);\n        // ctx.fillRect(gridBox.xOrigin + (gridBox.width / hsls.length) * j, gridBox.yOrigin, gridBox.width / hsls.length, gridBox.height);\n        // ctx.fill();\n\n        for (let i = 0; i < hslWithOvertones.length; i++)\n        {\n          if (!config.showOvertones && i > 0)\n            continue;\n\n          const hsl = hslWithOvertones[i];\n          drawNoteInBox(lightCircleBox, hsl, i, hsl => hsl.light, j == hsls.length - 1);\n          drawNoteInBox(satCircleBox, hsl, i, hsl => hsl.saturation, j == hsls.length - 1);\n        }\n      }\n\n    }\n  }\n\n// todo: resize\n  makeConcentricPixelator(ctx: CanvasRenderingContext2D, dimensions: CanvasOptions)\n  {\n    const width = dimensions.width;\n    const height = dimensions.height;\n\n    const totalElements = width * height * 4;\n    const arr = new Uint8ClampedArray(width * height * 4);\n    const imageData = new ImageData(arr, width);\n    return (rgbs: RGB[][], emergent: RGB[], emergentBias: number, emergentBiasFloor: number, \n      velocities: number[] | undefined) =>\n    {\n      // if (rgbs.length == 1)\n      // {\n      //   this.randomPixelator(rgbs[0]);\n      //   return;\n      // }\n      const loopTimeStart = performance.now();\n      let multiplier = totalElements / rgbs.length - 1; multiplier -= (multiplier % 4);\n      multiplier = Math.min(multiplier, totalElements);\n      const end = multiplier;\n      const begin = 0;\n\n      const midpoint = (end + begin) / 2;\n      const d = (end - begin) / 2;\n\n      for (let i = 0; i < end; i+=4)\n      {\n        const useEmergentCeiling = (Math.abs(i - midpoint) / d) * emergentBias;\n        const useEmergenceBase =  Math.random() - emergentBiasFloor;\n        for (let j = 0; j < rgbs.length; j++)\n        {\n          const c = useEmergenceBase < useEmergentCeiling\n            ? emergent[Math.floor(Math.random()*emergent.length)]\n            : rgbs[rgbs.length - j - 1][Math.floor(Math.random()*rgbs[j].length)];\n            arr[j*multiplier + i] = c.red;\n            arr[j*multiplier + i + 1] = c.green;\n            arr[j*multiplier + i + 2] = c.blue;\n            arr[j*multiplier + i + 3] = 255;\n        }\n      }\n\n      const loopTimeEnd = performance.now();\n      // console.log(\"loop time: \" + (loopTimeEnd - loopTimeStart));\n\n      ctx.putImageData(imageData, 0, 0);\n    }\n  }\n\n  mounted()\n  {\n    const canvas = document.getElementById(\"canvas\") as HTMLCanvasElement;\n    const ctx = canvas.getContext(\"2d\")!;\n    this.ctx = ctx;\n\n    this.resize();\n\n      let noNotesForMs = 0;\n      const tryClear = () => {\n        if (noNotesForMs > this.options.display.waitBeforeClearMilliseconds) {\n          ctx.clearRect(0, 0, this.options.canvas.width, this.options.canvas.height);\n          noNotesForMs = 0;\n        } else {\n          noNotesForMs += this.options.display.tickMilliseconds;\n        }\n      }\n\n      const renderSingleColor = () => {\n        const notes = this.midiBatcher.getNotes();\n        const colors = notesToColors(this.options.circle, this.options.color, notes);\n        if (colors.length == 0)\n          tryClear();\n        \n        else\n        {\n          const color = mixColors(this.options.mix, colors, notes.map(n => n.velocity));\n          ctx.clearRect(0, 0, this.options.canvas.width, this.options.canvas.height);\n          ctx.rect(0, 0, this.options.canvas.width, this.options.canvas.height);\n          ctx.fillStyle = hslToHex(color);\n          ctx.fill();\n        }\n    };\n\n      const renderOvertonesGrid = () => {\n        const notes = this.midiBatcher.getNotes();\n        const colors = notesToColors(this.options.circle, this.options.color, notes);\n        if (colors.length == 0)\n          tryClear();\n\n        else\n        {\n          const withOvertones = colors.map(c => colorOvertones(c, this.options.overtone).map(wc => wc.color));\n          withOvertones.push(flipMap(withOvertones, c => mixColors(this.options.mix, c, notes.map(n => n.velocity))));\n          const hexOvertones = deepMap(withOvertones, hslToHex);\n          this.drawAll(ctx, hexOvertones, { width: this.options.canvas.width, height: this.options.canvas.height, xOrigin: 0, yOrigin: 0});\n        }\n      }\n\n\n      const pixelateConcentrically = () => {\n        const notes = this.midiBatcher.getNotes();\n        const velocities = notes.map(n => n.velocity);\n        const rawColors = notesToColors(this.options.circle, this.options.color, notes);\n        if (rawColors.length == 0)\n          tryClear();\n        \n        else\n        {\n          // first, weight with overtones, then weight with root/middle/etc. etc.?\n          const cs = [... rawColors];\n          const withOvertones = cs.map(c => colorOvertones(c, this.options.overtone));\n          const emergent = cs.length > 0 ? colorOvertones(mixColors(this.options.mix, cs, velocities), this.options.overtone) : [];\n\n          const drawingPool: RGB[][] = [];\n          withOvertones.forEach(wcs => {\n            const result: RGB[] = [];\n            wcs.forEach(wc => {\n              const rgb = hslToRGB(wc.color);\n              // todo: could write reusable function that looked at smallest weight and determined min number needed to have that represented once?\n              for (let i = 0; i < Math.floor(100 * wc.weight); i++)\n                result.push(rgb);\n            });\n            drawingPool.push(result);\n            }\n          );\n\n          const emergentDrawingPool: RGB[] = [];\n          emergent.forEach(wc => {\n            const rgb = hslToRGB(wc.color);\n            for (let i = 0; i < Math.floor(100 * wc.weight); i++)\n              emergentDrawingPool.push(rgb);\n          });\n\n          this.concentricPixelator(drawingPool, emergentDrawingPool, \n            this.options.render.emergentBias, this.options.render.emergentBiasFloor,\n            this.options.mix.considerVelocity ? velocities : undefined);\n        }\n      }\n\n      const renderColorWheel = () =>\n      {\n        const notes = this.midiBatcher.getNotes();\n        const rawColors = notesToColors(this.options.circle, this.options.color, notes);\n        const cs = [... rawColors];\n        const withOvertones = cs.map(c => colorOvertones(c, this.options.overtone));\n        if (withOvertones.length > 0)\n        {\n          const emergent = colorOvertones(mixColors(this.options.mix, cs, notes.map(n => n.velocity)), this.options.overtone);\n          withOvertones.push(emergent);\n        }\n\n        this.wheelDrawer(deepMap(withOvertones, wc => wc.color), this.options, this.options.circle.degreeOffset);\n      }\n\n      const go = () => {\n        this.midiBatcher.tick();\n        this.options.viewMode.single ? renderSingleColor()\n        : this.options.viewMode.overtoneGrid ? renderOvertonesGrid()\n        : this.options.viewMode.wheel ? renderColorWheel()\n        : this.options.viewMode.randomPixelation ? this.randomPixelator(this.midiBatcher, makeRandomPixelatorConfig(this.options), tryClear)\n        : pixelateConcentrically();\n      }\n\n      const runLoop = () => {\n        go();\n        setTimeout(runLoop, this.options.display.tickMilliseconds);\n      }\n\n      setTimeout(runLoop, this.options.display.tickMilliseconds);\n\n      webmidi.enable(ex => {\n        if (ex != undefined) {\n          console.log(\"Error trying to setup midi listener: \" + ex.name);\n        } else {\n          console.log(\"Successfully set up midi listner.\")\n        }\n    \n        console.log(webmidi.inputs);\n        console.log(webmidi.outputs);\n    \n        if (webmidi.inputs.length == 0) {\n          console.log(\"No midi input device detected.\");\n        }\n    \n        const input = webmidi.inputs[0];\n        input.addListener(\"midimessage\", \"all\", e =>  {\n          if (e.data[0] >> 4 == 11 && e.data[1] == 64)\n          {\n            if (e.data[2] <= 63)\n              this.midiBatcher.endSustain();\n            else\n              this.midiBatcher.beginSustain();\n          }\n        });\n        input.addListener(\"noteon\", \"all\", e => {\n          this.midiBatcher.handleNoteOn(e.note.number, e.note.octave, e.velocity);\n        });\n    \n        input.addListener(\"noteoff\", \"all\", e => {\n          this.midiBatcher.handleNoteOff(e.note.number)\n        });\n      }, true);\n  }\n}\n\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=54811de0&\"\nimport script from \"./App.vue?vue&type=script&lang=ts&\"\nexport * from \"./App.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from \"vue\";\nimport App from \"./App.vue\";\nimport Vuetify from \"vuetify/lib\";\n\nimport 'vuetify/dist/vuetify.min.css';\n\nconst vuetify = new Vuetify({});\n\nVue.use(Vuetify);\n\nVue.config.productionTip = false;\n\nnew Vue({\n  vuetify,\n  render: h => h(App)\n}).$mount(\"#app\");"],"sourceRoot":""}