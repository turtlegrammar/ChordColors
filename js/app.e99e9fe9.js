(function(t){function n(n){for(var o,a,c=n[0],u=n[1],s=n[2],f=0,h=[];f<c.length;f++)a=c[f],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&h.push(r[a][0]),r[a]=0;for(o in u)Object.prototype.hasOwnProperty.call(u,o)&&(t[o]=u[o]);l&&l(n);while(h.length)h.shift()();return i.push.apply(i,s||[]),e()}function e(){for(var t,n=0;n<i.length;n++){for(var e=i[n],o=!0,c=1;c<e.length;c++){var u=e[c];0!==r[u]&&(o=!1)}o&&(i.splice(n--,1),t=a(a.s=e[0]))}return t}var o={},r={app:0},i=[];function a(n){if(o[n])return o[n].exports;var e=o[n]={i:n,l:!1,exports:{}};return t[n].call(e.exports,e,e.exports,a),e.l=!0,e.exports}a.m=t,a.c=o,a.d=function(t,n,e){a.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,n){if(1&n&&(t=a(t)),8&n)return t;if(4&n&&"object"===typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(a.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)a.d(e,o,function(n){return t[n]}.bind(null,o));return e},a.n=function(t){var n=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(n,"a",n),n},a.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},a.p="";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=n,c=c.slice();for(var s=0;s<c.length;s++)n(c[s]);var l=u;i.push([0,"chunk-vendors"]),e()})({0:function(t,n,e){t.exports=e("cd49")},"5c0b":function(t,n,e){"use strict";e("9c0c")},"9c0c":function(t,n,e){},cd49:function(t,n,e){"use strict";e.r(n);e("e260"),e("e6cf"),e("cca6"),e("a79d");var o=e("2b0e"),r=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("v-app",[e("v-main",[e("v-container",[e("v-row",[e("v-col",{staticClass:"lg-6"},[e("options-editor",{model:{value:t.options,callback:function(n){t.options=n},expression:"options"}})],1)],1),e("v-row",[e("canvas",{attrs:{id:"canvas",width:t.options.canvas.width,height:t.options.canvas.height}})])],1)],1)],1)},i=[],a=(e("cb29"),e("0481"),e("4160"),e("d81d"),e("4069"),e("b0c0"),e("d3b7"),e("8a59"),e("9a8c"),e("a975"),e("735e"),e("c1ac"),e("d139"),e("3a7b"),e("d5d6"),e("82f8"),e("e91f"),e("60bd"),e("5f96"),e("3280"),e("3fcc"),e("ca91"),e("25a1"),e("cd26"),e("3c5d"),e("2954"),e("649e"),e("219c"),e("170b"),e("b39a"),e("72f7"),e("159b"),e("2909")),c=e("d4ec"),u=e("bee2"),s=e("262e"),l=e("2caf"),f=e("9ab4"),h=e("1b40"),v=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("vue-json-editor",{attrs:{expandedOnStart:!0},on:{"json-change":t.onJsonChange},model:{value:t.options,callback:function(n){t.options=n},expression:"options"}})],1)},d=[],p=e("5530"),g=e("a523"),b=e("0fd9"),m=e("62ad"),y=e("b974"),w=e("ac7c"),O=e("8654"),x=e("8336"),M={circle:{tonic:"C",degreeOffset:60},viewMode:{single:!1,overtoneGrid:!1,randomPixelation:!1,concentricPixelation:!0},canvas:{width:1800,height:1190},mix:{rootBias:1.5,melodyBias:1.5},render:{rootBias:1,middleBias:1,melodyBias:1,emergentBias:1},overtone:{numberOvertones:7,backoffCoefficient:1.5}},j=e("45a3"),B=function(t){Object(s["a"])(e,t);var n=Object(l["a"])(e);function e(){var t;return Object(c["a"])(this,e),t=n.apply(this,arguments),t.options=Object(p["a"])({},M),t}return Object(u["a"])(e,[{key:"onJsonChange",value:function(t){this.options=t,this.emit()}},{key:"emit",value:function(){return this.options}}]),e}(h["c"]);Object(f["a"])([Object(h["b"])("input")],B.prototype,"emit",null),B=Object(f["a"])([Object(h["a"])({components:{VContainer:g["a"],VRow:b["a"],VCol:m["a"],VSelect:y["a"],VCheckbox:w["a"],VTextField:O["a"],VBtn:x["a"],vueJsonEditor:j["a"]}})],B);var k=B,E=k,P=e("2877"),C=Object(P["a"])(E,v,d,!1,null,null,null),_=C.exports,V=e("7496"),S=e("f6c4"),A=e("fe57"),D=e("71a3"),I=e("c671"),N=(e("25f0"),e("5e54"));e("4ec9"),e("6062"),e("3ca3"),e("ddb0");function R(t,n){var e=[];return t.forEach((function(t){n(t).forEach((function(t){return e.push(t)}))})),e}function F(t,n){return t.map((function(t){return t.map(n)}))}function T(t,n){for(var e=[],o=function(o){e.push(n(t.map((function(t){return t[o]}))))},r=0;r<t[0].length;r++)o(r);return e}function z(t,n){var e=t%12==9?"A":t%12==10?"Bb":t%12==11?"B":t%12==0?"C":t%12==1?"Db":t%12==2?"D":t%12==3?"Eb":t%12==4?"E":t%12==5?"F":t%12==6?"F#":t%12==7?"G":"Ab";return{kind:"scientific",class:e,octave:n}}var G=["A","Bb","B","C","Db","D","Eb","E","F","F#","G","Ab"];R([1,2,3,4,5,6,7,8],(function(t){return G.map((function(n){return n+t.toString()}))}));function J(t){return"midi"==t.kind?t.midi:"scientific"==t.kind?Object(N["a"])(t.class+t.octave.toString()).toMidi():$(t.solfege.solfege)+12*t.solfege.octaveOffset+J(t.tonic)}function $(t){return"do"==t?0:"ra"==t?1:"re"==t?2:"ri"==t||"me"==t?3:"mi"==t?4:"fa"==t?5:"fi"==t||"se"==t?6:"so"==t?7:"si"==t||"le"==t?8:"la"==t?9:"li"==t||"te"==t?10:"ti"==t?11:-1}e("4de4");var L=function(){function t(){Object(c["a"])(this,t),this._notes=[]}return Object(u["a"])(t,[{key:"handleNoteOn",value:function(t,n){this._notes.push({velocity:n,note:t,lifespan:0}),this._notes.sort((function(t,n){return J(t.note)-J(n.note)}))}},{key:"handleNoteOff",value:function(t){this._notes=this._notes.filter((function(n){return!(n.note.class==t.class&&n.note.octave==t.octave)}))}},{key:"getNotes",value:function(){return this._notes}},{key:"tick",value:function(t){this._notes.forEach((function(n){return n.lifespan=n.lifespan+t}))}}]),t}();e("99af"),e("13d5"),e("4d90");function U(t){var n,e,o,r=t.hue/360,i=t.light/100,a=t.saturation/100;if(0==a)n=e=o=i;else{var c=function(t,n,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?t+6*(n-t)*e:e<.5?n:e<2/3?t+(n-t)*(2/3-e)*6:t},u=i<.5?i*(1+a):i+a-i*a,s=2*i-u;n=c(s,u,r+1/3),e=c(s,u,r),o=c(s,u,r-1/3)}return{red:Math.round(255*n),green:Math.round(255*e),blue:Math.round(255*o)}}function q(t){var n=t.hue,e=t.light/100,o=t.saturation,r=o*Math.min(e,1-e)/100,i=function(t){var o=(t+n/30)%12,i=e-r*Math.max(Math.min(o-3,9-o,1),-1);return Math.round(255*i).toString(16).padStart(2,"0")};return"#".concat(i(0)).concat(i(8)).concat(i(4))}var H=new Map([["C",0],["G",30],["D",60],["A",90],["E",120],["B",150],["F#",180],["Db",210],["Ab",240],["Eb",270],["Bb",300],["F",330]]);function K(t,n){return n.map((function(n){return{hue:Math.abs(360-H.get(n.note.class)+t.degreeOffset+H.get(t.tonic))%360,saturation:100*(.7+.3*n.velocity),light:(J(n.note)-21)*(100/88)}}))}function Q(t){return{x:Math.cos(t.hue/180*Math.PI)*t.saturation,y:Math.sin(t.hue/180*Math.PI)*t.saturation,z:t.light}}function W(t){var n=180*Math.atan2(t.y,t.x)/Math.PI;return{hue:n<0?360+n:n,saturation:Math.sqrt(t.x*t.x+t.y*t.y),light:t.z}}function X(t,n){if(1==n.length)return n[0];for(var e=n.length-2,o=t.rootBias+t.melodyBias+e,r={x:0,y:0,z:0},i=0;i<n.length;i++){var a=0==i?t.rootBias:i==n.length-1?t.melodyBias:1,c=Q(n[i]);r.x+=c.x*a,r.y+=c.y*a,r.z+=c.z*a}return r.x/=o,r.y/=o,r.z/=o,W(r)}function Y(t,n){var e=function(n,e){return{hue:n,light:e,saturation:t.saturation}},o=function(n){return Math.min(100,100/88*n+t.light)},r=1,i=[{color:t,weight:1}],a=function(t){r++;var e=1/(n.backoffCoefficient*r);i.push({color:t,weight:e})};return n.numberOvertones>=1&&a(e(t.hue,o(12))),n.numberOvertones>=2&&a(e(t.hue-31,o(19))),n.numberOvertones>=3&&a(e(t.hue,o(24))),n.numberOvertones>=4&&a(e((t.hue-120+4.2)%360,o(28))),n.numberOvertones>=5&&a(e(t.hue-31,o(31))),n.numberOvertones>=6&&a(e((t.hue+60+9.3)%360,o(34))),Z(i),i}function Z(t){var n=t.map((function(t){return t.weight})).reduce((function(t,n){return t+n}),0);t.forEach((function(t){return t.weight/=n}))}var tt=e("c62b"),nt=e.n(tt),et=function(t){Object(s["a"])(e,t);var n=Object(l["a"])(e);function e(){var t;return Object(c["a"])(this,e),t=n.apply(this,arguments),t.options=M,t.midiBatcher=new L,t.ctx=void 0,t}return Object(u["a"])(e,[{key:"drawAll",value:function(t,n,e){for(var o=e.height,r=e.width,i=n.length,a=o/i,c=0;c<i;c++)for(var u=n[c],s=u.length,l=r/s,f=0;f<s;f++){var h=u[f];t.beginPath(),t.fillStyle=h,t.rect(f*l,c*a,l,a),t.fill()}}},{key:"makeRandomPixelator",value:function(t,n){var e=n.width,o=n.height,r=new Uint8ClampedArray(e*o*4),i=new ImageData(r,e);return function(n){for(var e=0;e<r.length;e+=4){var o=n[Math.floor(Math.random()*n.length)];r[e]=o.red,r[e+1]=o.green,r[e+2]=o.blue,r[e+3]=255}t.putImageData(i,0,0)}}},{key:"makeConcentricPixelator",value:function(t,n){var e=n.width,o=n.height,r=e*o*4,i=new Uint8ClampedArray(e*o*4),a=new ImageData(i,e);return function(n,e,o){for(var c=0;c<n.length;c++){var u=(c+1)*r/n.length-1;u-=u%4;var s=c*r/n.length;s-=s%4;for(var l=(u+s)/2,f=(u-s)/2,h=n[n.length-c-1],v=s;v<u;v+=4){var d=Math.random()<Math.abs(v-l)/f*o?e[Math.floor(Math.random()*e.length)]:h[Math.floor(Math.random()*h.length)];i[v]=d.red,i[v+1]=d.green,i[v+2]=d.blue,i[v+3]=255}}t.putImageData(a,0,0)}}},{key:"mounted",value:function(){var t=this,n=document.getElementById("canvas"),e=n.getContext("2d");this.ctx=e;var o=function(){var n=K(t.options.circle,t.midiBatcher.getNotes());if(0==n.length)null===e||void 0===e||e.clearRect(0,0,t.options.canvas.width,t.options.canvas.height);else{var o=X(t.options.mix,n);e.clearRect(0,0,t.options.canvas.width,t.options.canvas.height),e.rect(0,0,t.options.canvas.width,t.options.canvas.height),e.fillStyle=q(o),e.fill()}t.midiBatcher.tick(50)},r=function(){var n=K(t.options.circle,t.midiBatcher.getNotes());if(0==n.length)null===e||void 0===e||e.clearRect(0,0,t.options.canvas.width,t.options.canvas.height);else{var o=n.map((function(n){return Y(n,t.options.overtone).map((function(t){return t.color}))}));console.log(o),o.push(T(o,(function(n){return X(t.options.mix,n)})));var r=F(o,q);t.drawAll(e,r,t.options.canvas)}},i=function(){var n=K(t.options.circle,t.midiBatcher.getNotes());if(0==n.length)null===e||void 0===e||e.clearRect(0,0,t.options.canvas.width,t.options.canvas.height);else{var o=Object(a["a"])(n);o.length>1&&o.push(X(t.options.mix,o));for(var r=o.map((function(n){return Y(n,t.options.overtone)})),i=0;i<r.length;i++)0==i?r[i].forEach((function(n){return n.weight*=t.options.render.rootBias})):i==r.length-1?r[i].forEach((function(n){return n.weight*=t.options.render.emergentBias})):i==r.length-2?r[i].forEach((function(n){return n.weight*=t.options.render.melodyBias})):r[i].forEach((function(n){return n.weight*=t.options.render.middleBias}));var c=r.flat();Z(c);var u=[];c.forEach((function(t){for(var n=U(t.color),e=0;e<Math.floor(1e4*t.weight);e++)u.push(n)})),t.randomPixelator(u)}},c=function(){var n=K(t.options.circle,t.midiBatcher.getNotes());if(0==n.length)null===e||void 0===e||e.clearRect(0,0,t.options.canvas.width,t.options.canvas.height);else{var o=Object(a["a"])(n),r=o.map((function(n){return Y(n,t.options.overtone)})),i=Y(X(t.options.mix,o),t.options.overtone),c=[];r.forEach((function(t){var n=[];t.forEach((function(t){for(var e=U(t.color),o=0;o<Math.floor(100*t.weight);o++)n.push(e)})),c.push(n)}));var u=[];i.forEach((function(t){for(var n=U(t.color),e=0;e<Math.floor(100*t.weight);e++)u.push(n)})),t.concentricPixelator(c,u,t.options.render.emergentBias)}},u=function(){t.options.viewMode.single?o():t.options.viewMode.overtoneGrid?r():t.options.viewMode.randomPixelation?i():c()};setInterval(u,50),nt.a.enable((function(n){void 0!=n?console.log("Error trying to setup midi listener: "+n.name):console.log("Successfully set up midi listner."),console.log(nt.a.inputs),console.log(nt.a.outputs),0==nt.a.inputs.length&&console.log("No midi input device detected.");var e=nt.a.inputs[0];e.addListener("noteon","all",(function(n){t.midiBatcher.handleNoteOn(z(n.note.number,n.note.octave),n.velocity)})),e.addListener("noteoff","all",(function(n){t.midiBatcher.handleNoteOff(z(n.note.number,n.note.octave))}))}),!0)}},{key:"randomPixelator",get:function(){return void 0==this.ctx?function(t){}:this.makeRandomPixelator(this.ctx,this.options.canvas)}},{key:"concentricPixelator",get:function(){return void 0==this.ctx?function(t,n,e){}:this.makeConcentricPixelator(this.ctx,this.options.canvas)}}]),e}(h["c"]);et=Object(f["a"])([Object(h["a"])({components:{OptionsEditor:_,VApp:V["a"],VMain:S["a"],VTabs:A["a"],VTab:D["a"],VTabItem:I["a"],VContainer:g["a"],VRow:b["a"],VCol:m["a"],VBtn:x["a"]}})],et);var ot=et,rt=ot,it=(e("5c0b"),Object(P["a"])(rt,r,i,!1,null,null,null)),at=it.exports,ct=e("f309"),ut=(e("bf40"),new ct["a"]({}));o["a"].use(ct["a"]),o["a"].config.productionTip=!1,new o["a"]({vuetify:ut,render:function(t){return t(at)}}).$mount("#app")}});
//# sourceMappingURL=app.e99e9fe9.js.map