(function(t){function e(e){for(var o,a,c=e[0],u=e[1],s=e[2],f=0,h=[];f<c.length;f++)a=c[f],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&h.push(i[a][0]),i[a]=0;for(o in u)Object.prototype.hasOwnProperty.call(u,o)&&(t[o]=u[o]);l&&l(e);while(h.length)h.shift()();return r.push.apply(r,s||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],o=!0,c=1;c<n.length;c++){var u=n[c];0!==i[u]&&(o=!1)}o&&(r.splice(e--,1),t=a(a.s=n[0]))}return t}var o={},i={app:0},r=[];function a(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=o,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(n,o,function(e){return t[e]}.bind(null,o));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=e,c=c.slice();for(var s=0;s<c.length;s++)e(c[s]);var l=u;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("cd49")},"5c0b":function(t,e,n){"use strict";n("9c0c")},"9c0c":function(t,e,n){},cd49:function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",[n("v-main",[n("v-container",[n("v-row",[n("v-col",{staticClass:"lg-6"},[n("options-editor",{model:{value:t.options,callback:function(e){t.options=e},expression:"options"}})],1)],1),n("v-row",[n("canvas",{attrs:{id:"canvas",width:t.options.canvas.width,height:t.options.canvas.height}})])],1)],1)],1)},r=[],a=(n("cb29"),n("0481"),n("4160"),n("d81d"),n("4069"),n("b0c0"),n("d3b7"),n("8a59"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("159b"),n("2909")),c=n("d4ec"),u=n("bee2"),s=n("262e"),l=n("2caf"),f=n("9ab4"),h=n("1b40"),d=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("vue-json-editor",{attrs:{expandedOnStart:!0},on:{"json-change":t.onJsonChange},model:{value:t.options,callback:function(e){t.options=e},expression:"options"}})],1)},p=[],v=n("5530"),g=n("a523"),m=n("0fd9"),b=n("62ad"),y=n("b974"),w=n("ac7c"),O=n("8654"),x=n("8336"),M={display:{waitBeforeClearMilliseconds:100,tickMilliseconds:5},circle:{tonic:"C",degreeOffset:60},viewMode:{single:!1,overtoneGrid:!1,randomPixelation:!1,concentricPixelation:!0},canvas:{width:1800,height:1190},mix:{rootBias:1.5,melodyBias:1.5},render:{rootBias:1,middleBias:1,melodyBias:1,emergentBias:1},overtone:{numberOvertones:7,backoffCoefficient:1.5}},B=n("45a3"),j=function(t){Object(s["a"])(n,t);var e=Object(l["a"])(n);function n(){var t;return Object(c["a"])(this,n),t=e.apply(this,arguments),t.options=Object(v["a"])({},M),t}return Object(u["a"])(n,[{key:"onJsonChange",value:function(t){this.options=t,this.emit()}},{key:"emit",value:function(){return this.options}}]),n}(h["c"]);Object(f["a"])([Object(h["b"])("input")],j.prototype,"emit",null),j=Object(f["a"])([Object(h["a"])({components:{VContainer:g["a"],VRow:m["a"],VCol:b["a"],VSelect:y["a"],VCheckbox:w["a"],VTextField:O["a"],VBtn:x["a"],vueJsonEditor:B["a"]}})],j);var k=j,E=k,P=n("2877"),C=Object(P["a"])(E,d,p,!1,null,null,null),_=C.exports,V=n("7496"),S=n("f6c4"),A=n("fe57"),D=n("71a3"),N=n("c671"),I=(n("25f0"),n("5e54"));n("4ec9"),n("6062"),n("3ca3"),n("ddb0");function T(t,e){var n=[];return t.forEach((function(t){e(t).forEach((function(t){return n.push(t)}))})),n}function F(t,e){return t.map((function(t){return t.map(e)}))}function z(t,e){for(var n=[],o=function(o){n.push(e(t.map((function(t){return t[o]}))))},i=0;i<t[0].length;i++)o(i);return n}function R(t,e){var n=t%12==9?"A":t%12==10?"Bb":t%12==11?"B":t%12==0?"C":t%12==1?"Db":t%12==2?"D":t%12==3?"Eb":t%12==4?"E":t%12==5?"F":t%12==6?"F#":t%12==7?"G":"Ab";return{kind:"scientific",class:n,octave:e}}var G=["A","Bb","B","C","Db","D","Eb","E","F","F#","G","Ab"];T([1,2,3,4,5,6,7,8],(function(t){return G.map((function(e){return e+t.toString()}))}));function J(t){return"midi"==t.kind?t.midi:"scientific"==t.kind?Object(I["a"])(t.class+t.octave.toString()).toMidi():$(t.solfege.solfege)+12*t.solfege.octaveOffset+J(t.tonic)}function $(t){return"do"==t?0:"ra"==t?1:"re"==t?2:"ri"==t||"me"==t?3:"mi"==t?4:"fa"==t?5:"fi"==t||"se"==t?6:"so"==t?7:"si"==t||"le"==t?8:"la"==t?9:"li"==t||"te"==t?10:"ti"==t?11:-1}n("4de4");var L=function(){function t(){Object(c["a"])(this,t),this._notes=[]}return Object(u["a"])(t,[{key:"handleNoteOn",value:function(t,e){this._notes.push({velocity:e,note:t,lifespan:0}),this._notes.sort((function(t,e){return J(t.note)-J(e.note)}))}},{key:"handleNoteOff",value:function(t){this._notes=this._notes.filter((function(e){return!(e.note.class==t.class&&e.note.octave==t.octave)}))}},{key:"getNotes",value:function(){return this._notes}},{key:"tick",value:function(t){this._notes.forEach((function(e){return e.lifespan=e.lifespan+t}))}}]),t}();n("99af"),n("13d5"),n("4d90");function U(t){var e,n,o,i=t.hue/360,r=t.light/100,a=t.saturation/100;if(0==a)e=n=o=r;else{var c=function(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t},u=r<.5?r*(1+a):r+a-r*a,s=2*r-u;e=c(s,u,i+1/3),n=c(s,u,i),o=c(s,u,i-1/3)}return{red:Math.round(255*e),green:Math.round(255*n),blue:Math.round(255*o)}}function q(t){var e=t.hue,n=t.light/100,o=t.saturation,i=o*Math.min(n,1-n)/100,r=function(t){var o=(t+e/30)%12,r=n-i*Math.max(Math.min(o-3,9-o,1),-1);return Math.round(255*r).toString(16).padStart(2,"0")};return"#".concat(r(0)).concat(r(8)).concat(r(4))}var H=new Map([["C",0],["G",30],["D",60],["A",90],["E",120],["B",150],["F#",180],["Db",210],["Ab",240],["Eb",270],["Bb",300],["F",330]]);function K(t,e){return e.map((function(e){return{hue:Math.abs(360-H.get(e.note.class)+t.degreeOffset+H.get(t.tonic))%360,saturation:100*(.7+.3*e.velocity),light:(J(e.note)-21)*(100/88)}}))}function Q(t){return{x:Math.cos(t.hue/180*Math.PI)*t.saturation,y:Math.sin(t.hue/180*Math.PI)*t.saturation,z:t.light}}function W(t){var e=180*Math.atan2(t.y,t.x)/Math.PI;return{hue:e<0?360+e:e,saturation:Math.sqrt(t.x*t.x+t.y*t.y),light:t.z}}function X(t,e){if(1==e.length)return e[0];for(var n=e.length-2,o=t.rootBias+t.melodyBias+n,i={x:0,y:0,z:0},r=0;r<e.length;r++){var a=0==r?t.rootBias:r==e.length-1?t.melodyBias:1,c=Q(e[r]);i.x+=c.x*a,i.y+=c.y*a,i.z+=c.z*a}return i.x/=o,i.y/=o,i.z/=o,W(i)}function Y(t,e){var n=function(e,n){return{hue:e,light:n,saturation:t.saturation}},o=function(e){return Math.min(100,100/88*e+t.light)},i=1,r=[{color:t,weight:1}],a=function(t){i++;var n=1/(e.backoffCoefficient*i);r.push({color:t,weight:n})};return e.numberOvertones>=1&&a(n(t.hue,o(12))),e.numberOvertones>=2&&a(n(t.hue-31,o(19))),e.numberOvertones>=3&&a(n(t.hue,o(24))),e.numberOvertones>=4&&a(n((t.hue-120+4.2)%360,o(28))),e.numberOvertones>=5&&a(n(t.hue-31,o(31))),e.numberOvertones>=6&&a(n((t.hue+60+9.3)%360,o(34))),Z(r),r}function Z(t){var e=t.map((function(t){return t.weight})).reduce((function(t,e){return t+e}),0);t.forEach((function(t){return t.weight/=e}))}var tt=n("c62b"),et=n.n(tt),nt=function(t){Object(s["a"])(n,t);var e=Object(l["a"])(n);function n(){var t;return Object(c["a"])(this,n),t=e.apply(this,arguments),t.options=M,t.midiBatcher=new L,t.ctx=void 0,t}return Object(u["a"])(n,[{key:"drawAll",value:function(t,e,n){for(var o=n.height,i=n.width,r=e.length,a=o/r,c=0;c<r;c++)for(var u=e[c],s=u.length,l=i/s,f=0;f<s;f++){var h=u[f];t.beginPath(),t.fillStyle=h,t.rect(f*l,c*a,l,a),t.fill()}}},{key:"makeRandomPixelator",value:function(t,e){var n=e.width,o=e.height,i=new Uint8ClampedArray(n*o*4),r=new ImageData(i,n);return function(e){performance.now();for(var n=0;n<i.length;n+=4){var o=e[Math.floor(Math.random()*e.length)];i[n]=o.red,i[n+1]=o.green,i[n+2]=o.blue,i[n+3]=255}performance.now();t.putImageData(r,0,0)}}},{key:"makeConcentricPixelator",value:function(t,e){var n=this,o=e.width,i=e.height,r=o*i*4,a=new Uint8ClampedArray(o*i*4),c=new ImageData(a,o);return function(e,o,i){if(1!=e.length){performance.now();var u=r/e.length-1;u-=u%4;for(var s=u,l=0,f=(s+l)/2,h=(s-l)/2,d=0;d<s;d+=4)for(var p=Math.random()<Math.abs(d-f)/h*i,v=0;v<e.length;v++){var g=p?o[Math.floor(Math.random()*o.length)]:e[e.length-v-1][Math.floor(Math.random()*e[v].length)];a[v*u+d]=g.red,a[v*u+d+1]=g.green,a[v*u+d+2]=g.blue,a[v*u+d+3]=255}performance.now();t.putImageData(c,0,0)}else n.randomPixelator(e[0])}}},{key:"mounted",value:function(){var t=this,e=document.getElementById("canvas"),n=e.getContext("2d");this.ctx=n;var o=0,i=function(){o>t.options.display.waitBeforeClearMilliseconds?(n.clearRect(0,0,t.options.canvas.width,t.options.canvas.height),o=0):o+=t.options.display.tickMilliseconds},r=function(){var e=K(t.options.circle,t.midiBatcher.getNotes());if(0==e.length)i();else{var o=X(t.options.mix,e);n.clearRect(0,0,t.options.canvas.width,t.options.canvas.height),n.rect(0,0,t.options.canvas.width,t.options.canvas.height),n.fillStyle=q(o),n.fill()}t.midiBatcher.tick(50)},c=function(){var e=K(t.options.circle,t.midiBatcher.getNotes());if(0==e.length)i();else{var o=e.map((function(e){return Y(e,t.options.overtone).map((function(t){return t.color}))}));o.push(z(o,(function(e){return X(t.options.mix,e)})));var r=F(o,q);t.drawAll(n,r,t.options.canvas)}},u=function(){var e=K(t.options.circle,t.midiBatcher.getNotes());if(0==e.length)i();else{var n=Object(a["a"])(e);n.length>1&&n.push(X(t.options.mix,n));for(var o=n.map((function(e){return Y(e,t.options.overtone)})),r=0;r<o.length;r++)0==r?o[r].forEach((function(e){return e.weight*=t.options.render.rootBias})):r==o.length-1?o[r].forEach((function(e){return e.weight*=t.options.render.emergentBias})):r==o.length-2?o[r].forEach((function(e){return e.weight*=t.options.render.melodyBias})):o[r].forEach((function(e){return e.weight*=t.options.render.middleBias}));var c=o.flat();Z(c);var u=[];c.forEach((function(t){for(var e=U(t.color),n=0;n<Math.floor(1e4*t.weight);n++)u.push(e)})),t.randomPixelator(u)}},s=function(){var e=K(t.options.circle,t.midiBatcher.getNotes());if(0==e.length)i();else{var n=Object(a["a"])(e),o=n.map((function(e){return Y(e,t.options.overtone)})),r=Y(X(t.options.mix,n),t.options.overtone),c=[];o.forEach((function(t){var e=[];t.forEach((function(t){for(var n=U(t.color),o=0;o<Math.floor(100*t.weight);o++)e.push(n)})),c.push(e)}));var u=[];r.forEach((function(t){for(var e=U(t.color),n=0;n<Math.floor(100*t.weight);n++)u.push(e)})),t.concentricPixelator(c,u,t.options.render.emergentBias)}},l=function(){t.options.viewMode.single?r():t.options.viewMode.overtoneGrid?c():t.options.viewMode.randomPixelation?u():s()},f=function e(){l(),setTimeout(e,t.options.display.tickMilliseconds)};setTimeout(f,this.options.display.tickMilliseconds),et.a.enable((function(e){void 0!=e?console.log("Error trying to setup midi listener: "+e.name):console.log("Successfully set up midi listner."),console.log(et.a.inputs),console.log(et.a.outputs),0==et.a.inputs.length&&console.log("No midi input device detected.");var n=et.a.inputs[0];n.addListener("noteon","all",(function(e){t.midiBatcher.handleNoteOn(R(e.note.number,e.note.octave),e.velocity)})),n.addListener("noteoff","all",(function(e){t.midiBatcher.handleNoteOff(R(e.note.number,e.note.octave))}))}),!0)}},{key:"randomPixelator",get:function(){return void 0==this.ctx?function(t){}:this.makeRandomPixelator(this.ctx,this.options.canvas)}},{key:"concentricPixelator",get:function(){return void 0==this.ctx?function(t,e,n){}:this.makeConcentricPixelator(this.ctx,this.options.canvas)}}]),n}(h["c"]);nt=Object(f["a"])([Object(h["a"])({components:{OptionsEditor:_,VApp:V["a"],VMain:S["a"],VTabs:A["a"],VTab:D["a"],VTabItem:N["a"],VContainer:g["a"],VRow:m["a"],VCol:b["a"],VBtn:x["a"]}})],nt);var ot=nt,it=ot,rt=(n("5c0b"),Object(P["a"])(it,i,r,!1,null,null,null)),at=rt.exports,ct=n("f309"),ut=(n("bf40"),new ct["a"]({}));o["a"].use(ct["a"]),o["a"].config.productionTip=!1,new o["a"]({vuetify:ut,render:function(t){return t(at)}}).$mount("#app")}});
//# sourceMappingURL=app.f582cb89.js.map